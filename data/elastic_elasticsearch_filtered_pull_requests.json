[
    {
        "merged": false,
        "additions": 362,
        "deletions": 168,
        "changed_files": 29,
        "created_at": "2023-10-18T12:02:03Z",
        "closed_at": null,
        "merged_at": null,
        "body": "-- DRAFT --",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 328,
        "deletions": 18,
        "changed_files": 32,
        "created_at": "2023-10-18T11:46:32Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Backports the following commits to 8.11:\n - ESQL: Add warning header when default LIMIT is applied (#100894)",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 223,
        "deletions": 392,
        "changed_files": 60,
        "created_at": "2023-10-18T11:16:43Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Relates #97721",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 398,
        "deletions": 439,
        "changed_files": 13,
        "created_at": "2023-10-18T11:08:04Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Follow up to #100966 introducing new combined assertion `assertSearchHitsWithoutFailures` to combine no-failure, count, and id assertions into one block.\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 26,
        "deletions": 36,
        "changed_files": 3,
        "created_at": "2023-10-18T11:07:52Z",
        "closed_at": null,
        "merged_at": null,
        "body": "While dot expansion is disabled when parsing percolator queries at index time, as that would interfere with query parsing,  we still use a wrapper parser that is conservative about what methods it supports, assuming that document parsing needs nextToken and not much more. Turns out that when parsing queries instead, we need to support all the XContentParser methods including map, list etc.\r\n\r\nThis commit adds a test for script score query parsing through document parsing via percolator field mapper, and removes the limitations in the wrapper parser.\r\n\r\nCloses #97377",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 25,
        "deletions": 2,
        "changed_files": 3,
        "created_at": "2023-10-18T10:51:54Z",
        "closed_at": null,
        "merged_at": null,
        "body": "RemoteClusterNodesAction fetches NodesInfo with system context. It must restore the original caller's context when respond back. This PR ensures that.\r\n",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 1,
        "deletions": 6,
        "changed_files": 1,
        "created_at": "2023-10-18T10:14:36Z",
        "closed_at": null,
        "merged_at": null,
        "body": "While filling in the stacktrace has a cost that we could avoid if the exception never gets re-thrown, we know of cases where it is not caught properly which we want to track down, and that becomes very difficult without the stacktrace.\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 23,
        "deletions": 14,
        "changed_files": 4,
        "created_at": "2023-10-18T10:10:44Z",
        "closed_at": null,
        "merged_at": null,
        "body": "In https://github.com/elastic/elasticsearch/pull/100826 we made the boundaries for geotiles always behave properly in the lucene encoding space. This seems to upset how we adjust centroids when they are out of bounds on the vector tiles API. Let's adjust the boundaries here so the adjusted centroid is always in bounds.\r\n\r\nfixes https://github.com/elastic/elasticsearch/issues/101038",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 17,
        "deletions": 12,
        "changed_files": 1,
        "created_at": "2023-10-18T09:54:09Z",
        "closed_at": "2023-10-18T10:16:51Z",
        "merged_at": "2023-10-18T10:16:51Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.8`:\n - [[DOCS] Adds links to token section in ESLER conceptual. (#101033)](https://github.com/elastic/elasticsearch/pull/101033)\n\n<!--- Backport version: 9.3.0 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 21,
        "deletions": 13,
        "changed_files": 2,
        "created_at": "2023-10-18T09:51:21Z",
        "closed_at": "2023-10-18T10:08:36Z",
        "merged_at": "2023-10-18T10:08:36Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.9`:\n - [[DOCS] Adds links to token section in ESLER conceptual. (#101033)](https://github.com/elastic/elasticsearch/pull/101033)\n\n<!--- Backport version: 9.3.0 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 21,
        "deletions": 13,
        "changed_files": 2,
        "created_at": "2023-10-18T09:49:34Z",
        "closed_at": "2023-10-18T10:07:02Z",
        "merged_at": "2023-10-18T10:07:02Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.10`:\n - [[DOCS] Adds links to token section in ESLER conceptual. (#101033)](https://github.com/elastic/elasticsearch/pull/101033)\n\n<!--- Backport version: 9.3.0 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 267,
        "deletions": 26,
        "changed_files": 5,
        "created_at": "2023-10-18T09:35:15Z",
        "closed_at": "2023-10-18T10:17:29Z",
        "merged_at": "2023-10-18T10:17:29Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Support date and time intervals as input params (#101001)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 5,
        "changed_files": 2,
        "created_at": "2023-10-18T09:32:31Z",
        "closed_at": "2023-10-18T09:52:43Z",
        "merged_at": "2023-10-18T09:52:43Z",
        "body": "Backports the following commits to 8.11:\n - [DOCS] Adds links to token section in ESLER conceptual. (#101033)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-18T09:18:44Z",
        "closed_at": "2023-10-18T09:36:10Z",
        "merged_at": "2023-10-18T09:36:09Z",
        "body": "relates https://github.com/elastic/elasticsearch/issues/101038",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-18T08:58:36Z",
        "closed_at": "2023-10-18T09:13:38Z",
        "merged_at": null,
        "body": null,
        "comments": 1
    },
    {
        "merged": true,
        "additions": 3,
        "deletions": 7,
        "changed_files": 2,
        "created_at": "2023-10-18T08:50:12Z",
        "closed_at": "2023-10-18T11:54:48Z",
        "merged_at": "2023-10-18T11:54:48Z",
        "body": "Followup to #99129 and #100956",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 191,
        "deletions": 292,
        "changed_files": 62,
        "created_at": "2023-10-18T08:43:39Z",
        "closed_at": "2023-10-18T10:14:13Z",
        "merged_at": "2023-10-18T10:14:13Z",
        "body": "Got asked why we have these classes again last night ... figured I'd remove some of them to get us going here.\r\n\r\nNone of these classes are necessary, we can just inline all of these away and make `ActionType` itself final or a record now that the action type consists only in name and reader. See #97721 that made these things redundant I think.\r\n",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 13,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-18T08:38:04Z",
        "closed_at": "2023-10-18T09:20:12Z",
        "merged_at": "2023-10-18T09:20:12Z",
        "body": "Backports the following commits to 8.11:\n - [ML] Don't log errors for problems caused by shape of input data (#100996)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 5,
        "changed_files": 2,
        "created_at": "2023-10-18T08:23:38Z",
        "closed_at": "2023-10-18T09:30:38Z",
        "merged_at": "2023-10-18T09:30:38Z",
        "body": "## Overview\r\n\r\nThis PR links to the token description in the ELSER conceptual docs from sections in the ELSER tutorial that refer to tokens.\r\nIt also expands the WARNING text about the consequences of excluding fields from `_source` and links to documentation.\r\n\r\n### Preview\r\n\r\n* [Semantic search by using the `text_expansion` query](https://elasticsearch_101033.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/semantic-search-elser.html#text-expansion-query)\r\n* [Saving disk space by excluding the ELSER tokens from document source](https://elasticsearch_101033.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/semantic-search-elser.html#save-space)\r\n* [Generate text embeddings](https://elasticsearch_101033.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/semantic-search.html#semantic-search-generate-embeddings)\r\n",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 115,
        "deletions": 0,
        "changed_files": 4,
        "created_at": "2023-10-18T08:16:11Z",
        "closed_at": "2023-10-18T09:37:14Z",
        "merged_at": "2023-10-18T09:37:14Z",
        "body": "`TimeSeriesRateAggregator` requires processing docs in sorted order by `[_tsid, @timestamp]`. This is usually enforced when wrapping it with `TimeSeriesAggregator` that collects docs in this order. However, if  `TimeSeriesAggregator` is in turn wrapped with a subclass of `DeferableBucketAggregator`, the latter provides the doc ids to collect so in-order doc collection is bypassed. In this case, `TimeSeriesRateAggregator` can't process the docs properly and returns wrong results, e.g. \"Infinity\" or \"NaN\".\r\n\r\nUntil this case is properly supported, throw an exception to notify the user that this type of aggregation is not supported.\r\n\r\nRelated to #100945",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 282,
        "deletions": 50,
        "changed_files": 4,
        "created_at": "2023-10-18T07:35:38Z",
        "closed_at": "2023-10-18T09:33:22Z",
        "merged_at": "2023-10-18T09:33:22Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `7.17`:\n - [`WaitForSnapshotStep` verifies if the index belongs to the latest snapshot of that SLM policy (#100911)](https://github.com/elastic/elasticsearch/pull/100911)\n\n<!--- Backport version: 8.9.7 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 282,
        "deletions": 47,
        "changed_files": 4,
        "created_at": "2023-10-18T07:01:13Z",
        "closed_at": "2023-10-18T08:01:24Z",
        "merged_at": "2023-10-18T08:01:24Z",
        "body": "Backports the following commits to 8.11:\n - `WaitForSnapshotStep` verifies if the index belongs to the latest snapshot of that SLM policy (#100911)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 9,
        "deletions": 6,
        "changed_files": 5,
        "created_at": "2023-10-18T06:40:14Z",
        "closed_at": null,
        "merged_at": null,
        "body": "With this commit we remove the `auto_configure` privilege for the Fleet service account that targets profiling-related indices. This privilege was needed to automatically create indices and data streams in the past but as this managed by the Elasticsearch plugin, there is no need to grant this privilege to Fleet-managed components.",
        "comments": 6
    },
    {
        "merged": true,
        "additions": 146,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-18T03:57:16Z",
        "closed_at": "2023-10-18T10:48:37Z",
        "merged_at": "2023-10-18T10:48:37Z",
        "body": "This PR makes sure that the start message (\"deleting snapshots ...\") is logged after the cluster state is processed and any failures before finishing updating the new repositoryData are always logged at warning level.\r\n\r\nResolves: #99057\r\nResolves: #100481\r\n",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 24,
        "deletions": 9,
        "changed_files": 1,
        "created_at": "2023-10-18T01:32:14Z",
        "closed_at": "2023-10-18T09:54:35Z",
        "merged_at": "2023-10-18T09:54:35Z",
        "body": "Closing unassigned indices is not cleanly handled. This change avoids doing so in the test.\r\n\r\nResolves: #99516\r\n",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 30,
        "deletions": 4,
        "changed_files": 4,
        "created_at": "2023-10-17T22:55:31Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Migrates the painless and runtime-fields-common modules tests to the new test clusters framework.",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 2,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T21:22:33Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Since adding qualifier as a nullable string, the build utils which mutates Build objects for tests may experience an NPE. This commit handles null for string values.\r\n\r\ncloses #100994",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 945,
        "deletions": 101,
        "changed_files": 8,
        "created_at": "2023-10-17T20:52:50Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Synchronous gauges would only accept the most recent value, regardless of matching attributes.  As attributes should be treated as dimensions, we keep the most recent value with matching attributes.\r\n\r\n",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 24,
        "deletions": 3,
        "changed_files": 7,
        "created_at": "2023-10-17T19:23:26Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Extra logs and investigation for https://github.com/elastic/elasticsearch/issues/99778",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 10,
        "deletions": 11,
        "changed_files": 1,
        "created_at": "2023-10-17T19:22:34Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Adds some simple logging during ILM's `check-rollover-ready` step that specifies what conditions were checked and their status, it also logs whether the index was or was not ready for rollover according to those conditions.\r\n\r\nHere's an example:\r\n\r\n```\r\n[2023-10-13T16:10:08,282][DEBUG][o.e.x.c.i.WaitForRolloverReadyStep] [runTask-0] index [.ds-.slm-history-5-2023.10.13-000001] is not ready for rollover, conditionStatus [{[max_age: 30d]=false, [max_primary_shard_docs: 200000000]=false, [min_docs: 1]=true, [max_primary_shard_size: 50gb]=false}]\r\n[2023-10-13T16:10:08,282][DEBUG][o.e.x.c.i.WaitForRolloverReadyStep] [runTask-0] index [.ds-ilm-history-5-2023.10.13-000001] is not ready for rollover, conditionStatus [{[max_age: 30d]=false, [max_primary_shard_docs: 200000000]=false, [min_docs: 1]=true, [max_primary_shard_size: 50gb]=false}]\r\n[2023-10-13T16:10:08,285][DEBUG][o.e.x.c.i.WaitForRolloverReadyStep] [runTask-0] index [test-index-000001] is ready for rollover, conditionStatus [{[max_age: 1s]=true, [min_docs: 1]=true, [max_primary_shard_docs: 200000000]=false}]\r\n```\r\n\r\nI admit that debug logging is not ideal -- we don't typically have debug logging enabled, so the expected case is that these logs will not be seen. However, it can be enabled if something seems off with the rollover logic, so it's a switch that's available to us, and I think it'll be good to have. I hesitate to add it at a higher level of logging, though, because we'll be logging this every `indices.lifecycle.poll_interval` (10 minutes by default) and there can be be a lot of indices that are waiting for rollover at any given point. Seems too noisy to be `INFO`.\r\n\r\nThis came up in a couple of support tickets, and I'm finally turning my intention into action. \r\n\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 16,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T19:12:05Z",
        "closed_at": null,
        "merged_at": null,
        "body": "SuggestTests uses a fairly recursive way to create its test item. Those can end up with an CompletionSuggestion.Entry.Option that have a \"rank\" field set to something other than the bwc default of -1. The test still tries to test the serialization roundtrip to a random transport version down to TransportVersions.MINIMUM_COMPATIBLE which is currently at V_7_17_0, but the rank field serialization fails for anything below V_8_8_0. In reality however, suggester options shouldn't contain search hits with a set rank field, so simples way to avoid it is checking the randomly created test item for those cases and correct them before running the test.\r\n\r\nCloses #95607",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 29,
        "deletions": 3,
        "changed_files": 2,
        "created_at": "2023-10-17T19:03:00Z",
        "closed_at": "2023-10-18T07:06:43Z",
        "merged_at": "2023-10-18T07:06:43Z",
        "body": "8.10.4 includes a partial mitigation for the snapshots downgrades bug\r\nintroduced in 8.10.0. This commit adds known-issue docs for 8.10.4, and\r\nadjusts the known-issue docs for earlier 8.10.x issues.",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 16,
        "deletions": 7,
        "changed_files": 2,
        "created_at": "2023-10-17T18:59:33Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Adjust DateHistogram's consumeBucketsAndMaybeBreak to be iteratively during reduce instead accounting all buckets at the end of the reduce.\r\n\r\nIn case of many non-empty buckets accounting the number of buckets at the end of the reduce may be too late. Elasticsearch may already have failed with an OOME. This change changes the accounting to happen iteratively during the reduce for non-empty bucket.\r\n\r\nNote that for empty buckets accounting of the number of buckets already happens iteratively.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T18:34:07Z",
        "closed_at": "2023-10-17T19:15:59Z",
        "merged_at": "2023-10-17T19:15:59Z",
        "body": "Backports the following commits to 8.11:\n - Avoid release expanded block twice (#101005)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 33,
        "deletions": 17,
        "changed_files": 5,
        "created_at": "2023-10-17T18:23:01Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This pull request introduces a query pragma for configuring the maximum number of workers for enrich lookup. Increasing the number of workers can reduce latency but will also increase the load on the cluster. Similar to other pragmas, this feature is only available in snapshot builds and will be used to evaluate the performance of ESQL enrich.",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 0,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T17:43:41Z",
        "closed_at": null,
        "merged_at": null,
        "body": "it seems that https://github.com/elastic/elasticsearch/issues/96896 was fixed but the test was never unmuted.\r\n\r\nOr some race condition in folks muting/fixing/unmuting/remuting occurred.\r\n\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 51,
        "deletions": 39,
        "changed_files": 2,
        "created_at": "2023-10-17T17:40:26Z",
        "closed_at": null,
        "merged_at": null,
        "body": "I noticed that sometimes we read from the `fieldType()` and other times we read from the mapper directly. It seems to me that we should only ever read and update values from one of those, for sanity's sake. \r\n\r\nSo, I removed all values that were part of the mapper directly and used `fieldType().<value>` everywhere.\r\n\r\nAdditionally, David Turner suggested that we wait for cluster health before verifying mappings in the yaml tests, so I added that as well.\r\n\r\nrelated to: https://github.com/elastic/elasticsearch/issues/100502",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T17:29:25Z",
        "closed_at": "2023-10-17T18:33:06Z",
        "merged_at": "2023-10-17T18:33:06Z",
        "body": "The expanded block can be referred to the original block if the expanding block doesn't have multiple values. In this case, we should avoid closing it twice.\r\n\r\nCloses #101000",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 14,
        "deletions": 16,
        "changed_files": 5,
        "created_at": "2023-10-17T17:15:03Z",
        "closed_at": "2023-10-17T17:17:00Z",
        "merged_at": "2023-10-17T17:17:00Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `7.17`:\n - [[CI] Disable jenkins platform-support jobs, and re-enable all Buildkite periodic pipelines (#100630)](https://github.com/elastic/elasticsearch/pull/100630)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 21,
        "deletions": 23,
        "changed_files": 5,
        "created_at": "2023-10-17T17:13:58Z",
        "closed_at": "2023-10-17T17:16:37Z",
        "merged_at": "2023-10-17T17:16:37Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.10`:\n - [[CI] Disable jenkins platform-support jobs, and re-enable all Buildkite periodic pipelines (#100630)](https://github.com/elastic/elasticsearch/pull/100630)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 33,
        "deletions": 45,
        "changed_files": 6,
        "created_at": "2023-10-17T17:13:46Z",
        "closed_at": "2023-10-17T17:16:23Z",
        "merged_at": "2023-10-17T17:16:23Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.11`:\n - [[CI] Disable jenkins platform-support jobs, and re-enable all Buildkite periodic pipelines (#100630)](https://github.com/elastic/elasticsearch/pull/100630)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 267,
        "deletions": 26,
        "changed_files": 5,
        "created_at": "2023-10-17T16:44:51Z",
        "closed_at": "2023-10-18T09:33:06Z",
        "merged_at": "2023-10-18T09:33:06Z",
        "body": "Fixes https://github.com/elastic/elasticsearch/issues/99570\r\n\r\nAdd support for DATE_PERIOD and TYPE_DURATION values as input parameters, eg.\r\n\r\n```\r\n{\r\n   \"query\": \"row a = 1 | eval x = now() + ?\", \r\n   \"params\": [{\"type\":\"time_duration\", \"value\":\"5 hours\"}]\r\n}\r\n```\r\n\r\nThe values have to be passed as strings and then will be converted to the appropriate type.\r\n\r\nThe original issue also pointed to similar problems for Version type, so the PR also includes a test for this case.",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 7,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T16:41:02Z",
        "closed_at": "2023-10-17T18:55:21Z",
        "merged_at": "2023-10-17T18:55:21Z",
        "body": "The MappedActionFilter was added to make filtering more efficient, but the api filtering action filter was not yet using it. This commit adjusts this shared action filter to implement MappedActionFilter.\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 133,
        "deletions": 7,
        "changed_files": 24,
        "created_at": "2023-10-17T16:36:05Z",
        "closed_at": "2023-10-17T17:17:06Z",
        "merged_at": "2023-10-17T17:17:06Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: non-grouped aggregations not taking into account null groups (#100960)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 13,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-17T16:15:27Z",
        "closed_at": "2023-10-18T08:34:54Z",
        "merged_at": "2023-10-18T08:34:54Z",
        "body": "Logging errors in response to user input can cause enormous volumes of output, which then obscures errors caused by bugs in the software.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-17T15:49:12Z",
        "closed_at": "2023-10-17T17:49:39Z",
        "merged_at": "2023-10-17T17:49:39Z",
        "body": "This commit addes a getter on GetSettingsResponse\r\nto allow the recreation of GetSettingsResponse during response filtering.\r\n\r\n<!--\r\nThank you for your interest in and contributing to Elasticsearch! There\r\nare a few simple things to check before submitting your pull request\r\nthat can help with the review process. You should delete these items\r\nfrom your submission, but they are here to help bring them to your\r\nattention.\r\n-->\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)?\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)?\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`?\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed.\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)?\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.\r\n",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 1112,
        "deletions": 231,
        "changed_files": 122,
        "created_at": "2023-10-17T15:37:28Z",
        "closed_at": "2023-10-18T08:54:34Z",
        "merged_at": "2023-10-18T08:54:34Z",
        "body": "Backports the following commits to 8.11:\n - Restructure ES|QL docs (#100806)",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 94,
        "deletions": 3,
        "changed_files": 3,
        "created_at": "2023-10-17T15:37:19Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Currently the rest.suppressed logger in RestResponse logs the request path and the request parameters for 500 errors (warn level) and 400s (debug). In order to be able to filter on those status codes more efficiently we should add them to the log message.\r\nThis change also adds testing around the logic deciding when we log with respect to the request parameters.\r\n",
        "comments": 6
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T15:14:10Z",
        "closed_at": "2023-10-17T15:58:24Z",
        "merged_at": "2023-10-17T15:58:24Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Enhance test assertion in testSimpleFinishClose (#100971)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T15:14:09Z",
        "closed_at": "2023-10-17T16:00:48Z",
        "merged_at": "2023-10-17T16:00:48Z",
        "body": null,
        "comments": 2
    },
    {
        "merged": false,
        "additions": 6,
        "deletions": 1076,
        "changed_files": 68,
        "created_at": "2023-10-17T15:07:34Z",
        "closed_at": null,
        "merged_at": null,
        "body": "The vagrant related build logic hasn't been maintained in a while and the vagrant gradle plugin also broke compatibiliy\r\nfor gradle --configuration-cache.\r\nTo remove the surface of maintenance we remove support for running packaging tests via vagrant",
        "comments": 6
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 4,
        "changed_files": 2,
        "created_at": "2023-10-17T15:01:14Z",
        "closed_at": "2023-10-17T17:23:20Z",
        "merged_at": "2023-10-17T17:23:20Z",
        "body": "When a cluster state has been applied and right after the node becomes a candidate, there's a small race condition where the the thread scheduling can lead to closing the PeerFinder while the node is a Candidate.\r\n\r\nCloses #99023\r\n\r\nThe issue can be reproduced in `CoordinatorTests` with this change:\r\n```\r\ndiff --git a/server/src/main/java/org/elasticsearch/cluster/coordination/Coordinator.java b/server/src/main/java/org/elasticsearch/cluster/coordination/Coordinator.java\r\nindex cccc1b903ab..8cb21bfec54 100644\r\n--- a/server/src/main/java/org/elasticsearch/cluster/coordination/Coordinator.java\r\n+++ b/server/src/main/java/org/elasticsearch/cluster/coordination/Coordinator.java\r\n@@ -417,7 +417,7 @@ public class Coordinator extends AbstractLifecycleComponent implements ClusterSt\r\n         if (getMode() != Mode.CANDIDATE) {\r\n             joinHelper.onClusterStateApplied();\r\n             closeElectionScheduler();\r\n-            peerFinder.closePeers();\r\n+            clusterCoordinationExecutor.execute(peerFinder::closePeers);\r\n         }\r\n         if (getLocalNode().isMasterNode()) {\r\n             joinReasonService.onClusterStateApplied(applierState.nodes());\r\n```\r\n",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 347,
        "deletions": 339,
        "changed_files": 30,
        "created_at": "2023-10-17T14:58:51Z",
        "closed_at": "2023-10-18T05:20:02Z",
        "merged_at": "2023-10-18T05:20:02Z",
        "body": "Follow-up to #100966 adding more overrides to assertions that consume a request builder.\r\n",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 108,
        "deletions": 42,
        "changed_files": 6,
        "created_at": "2023-10-17T14:38:19Z",
        "closed_at": "2023-10-17T16:48:39Z",
        "merged_at": "2023-10-17T16:48:39Z",
        "body": "Backports the following commits to 8.11:\n - [DOCS] Alerts-as-data for anomaly detection rules (#100864)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T14:32:33Z",
        "closed_at": "2023-10-17T14:50:15Z",
        "merged_at": "2023-10-17T14:50:15Z",
        "body": "Backports the following commits to 8.10:\n - [DOCS] Remove the `coming[8.10.4]` from release notes (#100979)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T14:32:18Z",
        "closed_at": "2023-10-17T14:49:38Z",
        "merged_at": "2023-10-17T14:49:38Z",
        "body": "Backports the following commits to 8.11:\n - [DOCS] Remove the `coming[8.10.4]` from release notes (#100979)",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 0,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T14:09:20Z",
        "closed_at": "2023-10-17T14:25:07Z",
        "merged_at": null,
        "body": "Removes a \"coming\" tag from the 8.10.4 release notes.\r\n",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T14:08:58Z",
        "closed_at": "2023-10-17T14:29:15Z",
        "merged_at": "2023-10-17T14:29:15Z",
        "body": null,
        "comments": 3
    },
    {
        "merged": false,
        "additions": 0,
        "deletions": 31,
        "changed_files": 1,
        "created_at": "2023-10-17T14:08:32Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This test failed about 1% of the time in mixed clusters. We never figured out why, but since it was a test that really only needed to be run a few times to verify that the correct error is raised in mixed clusters, it was seen as very low priority, and considered better to just delete it.\r\n\r\nFixes #94239",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 1097,
        "deletions": 430,
        "changed_files": 32,
        "created_at": "2023-10-17T14:08:17Z",
        "closed_at": null,
        "merged_at": null,
        "body": "WIP",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 161,
        "deletions": 19,
        "changed_files": 8,
        "created_at": "2023-10-17T14:00:33Z",
        "closed_at": "2023-10-17T14:51:48Z",
        "merged_at": "2023-10-17T14:51:47Z",
        "body": "Backports the following commits to 8.11:\n - Improve painless error wrapping (#100872)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 339,
        "deletions": 21,
        "changed_files": 15,
        "created_at": "2023-10-17T13:57:57Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Second version of #100330, storing features in the top-level cluster state rather than in DiscoveryNode.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-17T13:55:22Z",
        "closed_at": "2023-10-17T15:01:34Z",
        "merged_at": "2023-10-17T15:01:34Z",
        "body": "See #100385",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 6,
        "changed_files": 2,
        "created_at": "2023-10-17T13:53:19Z",
        "closed_at": "2023-10-17T14:09:58Z",
        "merged_at": "2023-10-17T14:09:58Z",
        "body": "Backports the following commits to 8.10:\n - Fix synonyms documentation (#100916)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T13:39:34Z",
        "closed_at": "2023-10-17T15:13:09Z",
        "merged_at": "2023-10-17T15:13:09Z",
        "body": "This commit updates a test assertion so as to help with future diagnosis.",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 4,
        "deletions": 2,
        "changed_files": 2,
        "created_at": "2023-10-17T13:30:47Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This commit updates an incorrect PowTest scenario that depends on what randomisation input is generated.\r\n\r\nCurrently, the framework asserts that POSITIVE_INFINITY is never the expected result of an evaluate scenario, but POSITIVE_INFINITY is the exact expected result that is generated for a particular scenario. The randomisation bounds for the scenario allows a base of `0` and a negative exponent, which always results in POSITIVE_INFINITY. The fix here is to adjust the bounds for base to ensure that it is always >= 1.\r\n\r\ncloses #100915",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T13:20:30Z",
        "closed_at": "2023-10-17T15:38:03Z",
        "merged_at": null,
        "body": null,
        "comments": 0
    },
    {
        "merged": false,
        "additions": 50,
        "deletions": 8,
        "changed_files": 6,
        "created_at": "2023-10-17T13:20:28Z",
        "closed_at": null,
        "merged_at": null,
        "body": "The existing 500 error implies a temporary issue in the Elasticsearch server, which\r\nis not the case. So a 400 is more appropriate to indicate that the user needs to\r\ntake some action to avoid getting the error again.\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1127,
        "deletions": 1268,
        "changed_files": 98,
        "created_at": "2023-10-17T12:45:16Z",
        "closed_at": "2023-10-17T13:43:36Z",
        "merged_at": "2023-10-17T13:43:36Z",
        "body": "We'd like to make `SearchResponse` reference counted and pooled but there are around 6k instances of tests that create a `SearchResponse` local variable that would need to be released manually to avoid leaks in the tests.\r\nThis does away with about 10% of these spots by adding an override for `assertHitCount` that handles the actual execution of the search request and its release automatically and making use of it in all spots where the `.get()` on the request build could be inlined semi-automatically and in a straight-forward fashion without other code changes.\r\n",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 21,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-17T12:31:09Z",
        "closed_at": "2023-10-18T12:07:11Z",
        "merged_at": "2023-10-18T12:07:11Z",
        "body": "This updates the release notes for `8.11.0 BC3`",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 8,
        "changed_files": 1,
        "created_at": "2023-10-17T11:55:35Z",
        "closed_at": "2023-10-17T12:41:17Z",
        "merged_at": "2023-10-17T12:41:17Z",
        "body": "Recovery stats may contain additional entries, e.g. in case shards get \r\nrelocated. When restoring an index from its snapshot, it suffices to \r\ncheck that the index is health and searchable.\r\n\r\nFixes #98746\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 36,
        "deletions": 7,
        "changed_files": 9,
        "created_at": "2023-10-17T11:52:57Z",
        "closed_at": "2023-10-17T13:45:21Z",
        "merged_at": null,
        "body": null,
        "comments": 2
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T11:49:37Z",
        "closed_at": "2023-10-17T13:35:25Z",
        "merged_at": "2023-10-17T13:35:25Z",
        "body": "related: https://github.com/elastic/elasticsearch/issues/100502",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 133,
        "deletions": 7,
        "changed_files": 24,
        "created_at": "2023-10-17T11:01:00Z",
        "closed_at": "2023-10-17T16:35:06Z",
        "merged_at": "2023-10-17T16:35:06Z",
        "body": "This commit updates the non-grouping aggs so that they now take into consideration that the intermediate state can contain nulls - which is only emitted when the local execution planner determines that certain shards have no relevant data.\r\n\r\ncloses #100928",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 694,
        "deletions": 222,
        "changed_files": 13,
        "created_at": "2023-10-17T10:25:36Z",
        "closed_at": "2023-10-18T08:11:23Z",
        "merged_at": "2023-10-18T08:11:23Z",
        "body": "To solve an issue in serverless where multiple trained model allocations are assigned to a single node, this PR introduces the concept of \"fake\" availability zones, where each node is treated as being in its own availability zone.\r\n\r\nNote that further work is required in `elasticsearch-serverless` to create and register an instance of `NodeFakeAvailabilityZoneMapper`\r\n\r\n\r\n",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 3,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-17T10:18:19Z",
        "closed_at": "2023-10-17T10:35:36Z",
        "merged_at": "2023-10-17T10:35:36Z",
        "body": "Mutes https://github.com/elastic/elasticsearch/issues/92058\r\n\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 64,
        "deletions": 12,
        "changed_files": 2,
        "created_at": "2023-10-17T09:49:31Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Reapply https://github.com/elastic/elasticsearch/pull/100794\r\n\r\nThis will need to be merged (again) after https://github.com/elastic/elasticsearch/pull/100947 and then be followed by https://github.com/elastic/elasticsearch/pull/100746 OR follow quickly https://github.com/elastic/elasticsearch/pull/100746  to avoid disruption in serverless.",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 11,
        "deletions": 74,
        "changed_files": 10,
        "created_at": "2023-10-17T09:35:26Z",
        "closed_at": null,
        "merged_at": null,
        "body": "We currently set docIdsToLoad on SearchContext, and then pass the context to\r\nFetchPhase.execute() which reads the docIdsToLoad back out again.  This would\r\nbe considerably simpler if it was just a parameter on `execute()`.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-17T09:33:24Z",
        "closed_at": "2023-10-17T09:51:26Z",
        "merged_at": "2023-10-17T09:51:26Z",
        "body": "Mutes https://github.com/elastic/elasticsearch/issues/99355",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 30,
        "deletions": 7,
        "changed_files": 4,
        "created_at": "2023-10-17T09:20:27Z",
        "closed_at": null,
        "merged_at": null,
        "body": "<!--\r\nThank you for your interest in and contributing to Elasticsearch! There\r\nare a few simple things to check before submitting your pull request\r\nthat can help with the review process. You should delete these items\r\nfrom your submission, but they are here to help bring them to your\r\nattention.\r\n-->\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)? yes\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)? yes\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`? yes\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed.\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)? yes\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.\r\n\r\nResolves https://github.com/elastic/elasticsearch/issues/85747\r\n\r\nThe `elastic/fleet-server-remote` token would be used by Fleet Server to create API keys for that cluster to send those down to each Elastic Agent. Is the `manage_own_api_key` privilege sufficient for that? `elastic/fleet-server` has the same.\r\n\r\nOther than that adding `logs-*` and `metrics-*` `\"write\", \"create_index\", \"auto_configure\"` privileges to send monitoring data.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 18,
        "deletions": 19,
        "changed_files": 5,
        "created_at": "2023-10-17T09:01:19Z",
        "closed_at": "2023-10-17T09:42:20Z",
        "merged_at": "2023-10-17T09:42:20Z",
        "body": "Backports the following commits to 8.11:\n - [ML] Rename the ELSER service  (#100944)",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 2,
        "deletions": 2,
        "changed_files": 2,
        "created_at": "2023-10-17T08:33:57Z",
        "closed_at": null,
        "merged_at": null,
        "body": "In https://github.com/elastic/elasticsearch/pull/37537, we lowered the required file descriptor limit from 65536 to 65535. It seems a few occurrences of 65536 in the docs were not changed.",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 0,
        "deletions": 32,
        "changed_files": 3,
        "created_at": "2023-10-17T08:22:36Z",
        "closed_at": null,
        "merged_at": null,
        "body": "We reverted https://github.com/elastic/elasticsearch/pull/100794 (through https://github.com/elastic/elasticsearch/pull/100889) as some YAML tests were not passing on serverless (see https://gradle-enterprise.elastic.co/s/i6ntwjhsxtray).\r\n\r\nHowever, by submitting https://github.com/elastic/elasticsearch/pull/100746, we will break it again - the NodeInfo rest API will be updated to return Build.version(), but the YAML tests will not. There is no \"safe\" order to submit https://github.com/elastic/elasticsearch/pull/100746 and https://github.com/elastic/elasticsearch/pull/100794, change needs to happen on both sides.\r\n\r\nHowever, it is also true that the `node_selector` used in broken tests is a no-op: these tests do not run on a mixed cluster or during a rolling upgrade test, so `node_selector: current` will always return the whole set of nodes. \r\nRemoving the selector will make submitting https://github.com/elastic/elasticsearch/pull/100794 safe again - then, after https://github.com/elastic/elasticsearch/pull/100746, `node_selector: current` will also work for serverless under the new version scheme (if we need or want to introduce mixed cluster or rolling upgrade tests in the future).\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 2,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-17T08:16:39Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This test was disabled because of a warning. In the meanwhile the original test \r\nhas been moved to a new module and the warning message is not there anymore.\r\n\r\nResolves #97150 ",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 18,
        "deletions": 19,
        "changed_files": 5,
        "created_at": "2023-10-17T07:54:31Z",
        "closed_at": "2023-10-17T08:58:38Z",
        "merged_at": "2023-10-17T08:58:38Z",
        "body": "Rename from `elser_mlnode` -which was only a placeholder name- to `elser`",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-17T06:57:56Z",
        "closed_at": "2023-10-17T07:40:42Z",
        "merged_at": "2023-10-17T07:40:42Z",
        "body": "Emmited metrics could not be index as `elasticsearch.metrics.s3.exceptions` field is both long counter and a parent object for a histogram. This change renames histogram to avoid the conflict.\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-17T06:10:27Z",
        "closed_at": "2023-10-17T06:47:26Z",
        "merged_at": "2023-10-17T06:47:26Z",
        "body": "Backports the following commits to 7.17:\n - Add tolerance to ExtendedStatsAggregatorTests#testSummationAccuracy (#100917)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 20,
        "deletions": 3,
        "changed_files": 10,
        "created_at": "2023-10-17T05:51:53Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Relates #100466",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 253,
        "deletions": 59,
        "changed_files": 11,
        "created_at": "2023-10-17T05:31:12Z",
        "closed_at": "2023-10-17T06:11:39Z",
        "merged_at": "2023-10-17T06:11:39Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Preserve intermediate aggregation output in local relation (#100866)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 9,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-17T00:24:41Z",
        "closed_at": "2023-10-17T01:06:15Z",
        "merged_at": "2023-10-17T01:06:15Z",
        "body": "Backport of #100863 to 8.11\r\n\r\nThe test fails due to out-of-order documents in the enrich index. This can occur when replicas are initializing during indexing. To avoid this, we just need to ensure there are no initializing shards before starting indexing and disable shard relocations.\r\n\r\nCloses #99807",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 149,
        "deletions": 39,
        "changed_files": 2,
        "created_at": "2023-10-16T23:40:32Z",
        "closed_at": "2023-10-17T00:25:47Z",
        "merged_at": "2023-10-17T00:25:47Z",
        "body": "Backports the following commits to 8.11:\n - Perform enrich lookup with enrich_origin (#100856)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 222,
        "deletions": 18,
        "changed_files": 9,
        "created_at": "2023-10-16T22:47:38Z",
        "closed_at": "2023-10-16T23:34:08Z",
        "merged_at": "2023-10-16T23:34:08Z",
        "body": "Backports the following commits to 8.11:\n - QL: Preserve subfields for invalid types (#100875)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 72,
        "deletions": 12,
        "changed_files": 4,
        "created_at": "2023-10-16T22:12:43Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This change updates the core enrich java and yaml rests to run in the newer rest test framework.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 10,
        "changed_files": 1,
        "created_at": "2023-10-16T21:37:24Z",
        "closed_at": "2023-10-17T16:38:22Z",
        "merged_at": "2023-10-17T16:38:22Z",
        "body": "Backports the following commits to 8.11:\n - Refresh indicies before checking disk usage (#100845)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 201,
        "deletions": 60,
        "changed_files": 3,
        "created_at": "2023-10-16T21:29:07Z",
        "closed_at": null,
        "merged_at": null,
        "body": "- Simplify the search template used in the example\r\n- Show the search template used to generate the example query\r\n- Show via example how the search template is applied\r\n- Add a note about the `dictionary` parameter\r\n- Align language & examples used for Search Application Search and Render Search Application Query",
        "comments": 4
    },
    {
        "merged": false,
        "additions": 138,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-16T20:18:43Z",
        "closed_at": null,
        "merged_at": null,
        "body": "# Backport\n\nThis will backport the following commits from `main` to `7.17`:\n - [Update spotless plugin (#100666)](https://github.com/elastic/elasticsearch/pull/100666)\n\n<!--- Backport version: 8.9.8 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 18,
        "deletions": 20,
        "changed_files": 10,
        "created_at": "2023-10-16T20:09:39Z",
        "closed_at": "2023-10-17T11:44:48Z",
        "merged_at": "2023-10-17T11:44:48Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `7.17`:\n - [Update gradle wrapper to 8.4 (#99856)](https://github.com/elastic/elasticsearch/pull/99856)\n\n<!--- Backport version: 8.9.8 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 5,
        "deletions": 3,
        "changed_files": 1,
        "created_at": "2023-10-16T19:08:07Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Related to this comment: https://github.com/elastic/elasticsearch/pull/100674#discussion_r1358330688\r\n\r\nWe don't actually need to call this because we're not doing anything with the response.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 42,
        "changed_files": 1,
        "created_at": "2023-10-16T19:01:06Z",
        "closed_at": "2023-10-17T05:45:50Z",
        "merged_at": "2023-10-17T05:45:50Z",
        "body": "There's no need for the `fslike` repository, the thread-name check it\r\nexists to suppress permits execution on test threads so does not need\r\nsuppressing. This commit replaces it with a regular `fs` repository and\r\ncleans up a couple of other nits.",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 47,
        "deletions": 44,
        "changed_files": 12,
        "created_at": "2023-10-16T18:37:53Z",
        "closed_at": null,
        "merged_at": null,
        "body": null,
        "comments": 0
    },
    {
        "merged": false,
        "additions": 60,
        "deletions": 51,
        "changed_files": 3,
        "created_at": "2023-10-16T17:52:35Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This PR updates the docs \"Index Management in Kibana\".  Included are:\r\n\r\n- Data stream rentention values\r\n- Enrich policies\r\n- Updates to improve the flow of the doc\r\n\r\nThis PR addresses [this docs issue](https://github.com/elastic/platform-docs-team/issues/238).\r\n\r\nPreview:\r\n[Index Management in Kibana](https://elasticsearch_100922.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/index-mgmt.html)",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 7,
        "deletions": 0,
        "changed_files": 2,
        "created_at": "2023-10-16T17:43:18Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Starting from `org.apache.lucene.analysis` version 8.6, an Analyzer for the Serbian language is available. Within the `sr` folder, there is a `stopwords.txt` file that contains the default stopwords for the Serbian language. However, the current usage of Serbian stopwords does not function correctly because in the `Analysis `class, within the `NAMED_STOP_WORDS` map, an entry for Serbian has not been added.\r\n\r\n<!--\r\nThank you for your interest in and contributing to Elasticsearch! There\r\nare a few simple things to check before submitting your pull request\r\nthat can help with the review process. You should delete these items\r\nfrom your submission, but they are here to help bring them to your\r\nattention.\r\n-->\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)?\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)?\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`?\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed.\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)?\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.\r\n",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 703,
        "deletions": 109,
        "changed_files": 12,
        "created_at": "2023-10-16T17:13:33Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This PR is a follow on for https://github.com/elastic/elasticsearch/pull/100674.\r\n\r\nIt adds robustness for a node shutdown and timeouts for 3rd party inference requests that could be queued up on the node for a while. The implemented solution for timeouts is similar to the pytorch executor service in that each http request can have a timeout so that it can fail if it has been waiting in the queue for too long. This also adds functionality to notify any queued requests of a rejection after the service shuts down.\r\n\r\nI also changed a bunch of logs from error to warn because they really aren't that bad.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 9,
        "deletions": 18,
        "changed_files": 1,
        "created_at": "2023-10-16T17:06:25Z",
        "closed_at": "2023-10-16T17:47:12Z",
        "merged_at": "2023-10-16T17:47:12Z",
        "body": "It appears that some freshly generated tokens fail authn under\r\nconcurrency conditions.\r\nThis change increases verbosity of the TokenService logging\r\nin order to track down how exactly is the token not good for authn.\r\n\r\nRelated: https://github.com/elastic/elasticsearch/issues/85697",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 257,
        "deletions": 312,
        "changed_files": 46,
        "created_at": "2023-10-16T16:49:40Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This updates the use of certain exceptions in the EQL base. The failures that occur due to either user-provided input (such as incorrect query, incorrect query parameters), or data format not appropriate to the attempted operation (like converting strings to various other types) will now result in a 4xx type code, rather than 5xx.\r\n\r\nThis change also proposes turning `QlClientException` concrete, by implementing the `status()` method to return a `BAD_REQUEST` (400). The 400 is a \"generic\", catch-all client-side error message. The other 4xx errors are specializations. No QL code / exception makes use of specializations, but if they so wish, they can simply override the method.\r\nThis also makes it clearer to any subclass that a 4xx status must be return.\r\n\r\nThis change allows the use of some currently abstract subclasses, such as `EqlClientException`, which can be employed on user-related failures, that are currently inappropriately raised as a form of `QlIllegalArgumentException`, which is a 500-type error.\r\n\r\nAlso, a `QlClientIllegalArgumentException` extending `QlClientException` is introduced, being thrown from QL base and EQL's, where the execution cannot continue due to user's query.\r\n\r\nNote: PR touches QL and SQL and ESQL plugins, but just due to QL shared code. There will be additional PRs to handle SQL's use of 500-error code-generating exceptions. ",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-16T16:38:13Z",
        "closed_at": "2023-10-17T06:08:05Z",
        "merged_at": "2023-10-17T06:08:05Z",
        "body": "There was a test failure reported in 7.17 but I could reproduce it in main with the following seed:\r\n\r\n```\r\n./gradlew ':server:test' --tests \"org.elasticsearch.search.aggregations.metrics.ExtendedStatsAggregatorTests.testSummationAccuracy\" -Dtests.seed=6B6E3126F645B5CB:44D44F56A999020D\r\n```\r\n\r\nThere are just some combinations on how the data is indexed that can result in some precision loss. Let's add some tolerance into the test.\r\n\r\nfixes https://github.com/elastic/elasticsearch/issues/99465",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 6,
        "changed_files": 2,
        "created_at": "2023-10-16T15:30:42Z",
        "closed_at": "2023-10-17T13:50:52Z",
        "merged_at": "2023-10-17T13:50:52Z",
        "body": "Fix documentation related synonym / synonym graph token filters\r\n",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-16T14:44:05Z",
        "closed_at": "2023-10-16T15:00:30Z",
        "merged_at": "2023-10-16T15:00:30Z",
        "body": "Yet another test affected by the fix for showing the synthetic source, #98808. This can trigger an assert in older versions as the mapping they produce (without synthetic source) doesn't match the one they may get from the master, if the latter is in version 8.10+.\r\n\r\nFixes #100913",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 28,
        "deletions": 26,
        "changed_files": 1,
        "created_at": "2023-10-16T14:07:21Z",
        "closed_at": "2023-10-16T15:28:28Z",
        "merged_at": "2023-10-16T15:28:28Z",
        "body": null,
        "comments": 1
    },
    {
        "merged": true,
        "additions": 282,
        "deletions": 47,
        "changed_files": 4,
        "created_at": "2023-10-16T13:44:01Z",
        "closed_at": "2023-10-18T07:00:09Z",
        "merged_at": "2023-10-18T07:00:09Z",
        "body": "The `WaitForSnapshotStep` used to check if the SLM policy has been executed after the index has entered the delete phase, but it did not check if the SLM policy included this index.\r\n\r\nThe result of this is that if the user used an SLM policy that did not include this index, when the index would enter the `WaitForSnapshotStep`, it would wait for a snapshot to be taken, a snapshot that would not include the index, and then ILM would delete the index.\r\n\r\nSee the exact reproduction path: https://github.com/elastic/elasticsearch/issues/57809\r\n\r\n**Solution**\r\nThis PR, after it finds a successful SLM run, it verifies if the snapshot taken by SLM contains this index. If not it throws an error, otherwise it proceeds.\r\n\r\nILM explain will report:\r\n```\r\n\"step_info\": {\r\n        \"type\": \"illegal_state_exception\",\r\n        \"reason\": \"the last successful snapshot of policy 'hourly-snapshots' does not include index '.ds-my-other-stream-2023.10.16-000001'\"\r\n      }\r\n```\r\n\r\n**Backwards compatibility concerns**\r\nIn this PR, the `WaitForSnapshotStep` changed from `ClusterStateWaitStep` to `AsyncWaitStep`. We do not think this is gonna cause an issue. This was tested manually by the following steps:\r\n- Run a master node with the old version.\r\n- When ILM is executing `wait-for-snapshot`, we shutdown the node\r\n- We start the node again with the new version os ES\r\n- ES was able to pick up the step and continue with the new code.\r\n\r\nWe believe that this covers bwc concerns.\r\n\r\n\r\nFixes: https://github.com/elastic/elasticsearch/issues/57809",
        "comments": 10
    },
    {
        "merged": true,
        "additions": 55,
        "deletions": 256,
        "changed_files": 3,
        "created_at": "2023-10-16T13:38:39Z",
        "closed_at": "2023-10-16T16:48:53Z",
        "merged_at": "2023-10-16T16:48:53Z",
        "body": "If ML serverless autoscaling fails to return a response within the configured timeout period then the control plane autoscaler will log an error. Too many of these errors will raise an alert, therefore as much as possible should be done on the ML side to _not_ time out.\r\n\r\nPreviously there were two possible causes of timeouts:\r\n\r\n1. If a request for node stats from all ML nodes timed out\r\n2. If a request to refresh the ML memory tracker timed out\r\n\r\nThe first case can happen if a node leaves the cluster at a bad time and the message sent to it gets lost. The second case can happen if searching the ML results indices for model size stats documents is slow.\r\n\r\nWe can avoid timeouts in these two situations as follows:\r\n\r\n1. There was no need to use the API to get the only value from the node stats that the autoscaler needs to know - the total amount of memory on each ML node is stored in a node attribute on startup so exists in cluster state\r\n2. When we refresh the ML memory tracker we can just return stats that instruct the autoscaler to do nothing until the refresh is complete - this is functionally the same as timing out each request, but without generating error messages",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 33,
        "deletions": 2,
        "changed_files": 2,
        "created_at": "2023-10-16T13:32:19Z",
        "closed_at": "2023-10-16T14:27:42Z",
        "merged_at": "2023-10-16T14:27:42Z",
        "body": "Backports the following commits to 8.11:\n - Register TopN status in plugin's writables (#100874)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 10,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-16T12:38:12Z",
        "closed_at": "2023-10-16T15:06:14Z",
        "merged_at": "2023-10-16T15:06:14Z",
        "body": "Backport of https://github.com/elastic/elasticsearch/pull/100682 to 8.11",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 968,
        "deletions": 89,
        "changed_files": 51,
        "created_at": "2023-10-16T12:34:01Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This PR builds on the work done in https://github.com/elastic/elasticsearch/pull/100644 (which is also a prereq).\r\n\r\nOnce the above PR is merged I will rebase off master.\r\n\r\nThe aim is to emit metrics for the various threadpools, the metric callback should be created when the threadpool is created, and removed before the threadpool is shutdown.\r\n",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-16T12:29:57Z",
        "closed_at": "2023-10-16T13:19:15Z",
        "merged_at": "2023-10-16T13:19:15Z",
        "body": "Set number of replicas to 1 so the test can run against serverless.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 9,
        "changed_files": 2,
        "created_at": "2023-10-16T12:23:52Z",
        "closed_at": "2023-10-16T13:20:54Z",
        "merged_at": "2023-10-16T13:20:54Z",
        "body": "Backports the following commits to 8.11:\n - Don't hold onto ClusterState reference in AbstractSearchAsyncAction (#100901)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-16T12:05:52Z",
        "closed_at": "2023-10-16T14:31:09Z",
        "merged_at": "2023-10-16T14:31:09Z",
        "body": "Changes committed in #100737 need to be cross-ported to include\r\nthe extra index version in this branch.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 9,
        "changed_files": 2,
        "created_at": "2023-10-16T10:49:09Z",
        "closed_at": "2023-10-16T12:20:39Z",
        "merged_at": "2023-10-16T12:20:39Z",
        "body": "If the cluster state is changing quickly while searches are starting then these \r\ncaptured cluster states can consume substantial memory, and we are only \r\ninterested in two values here.  This commit extracts the two relevant values\r\nin the constructor, removing the cluster state references entirely.\r\n\r\nCloses #100120",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-16T10:35:58Z",
        "closed_at": "2023-10-17T07:14:44Z",
        "merged_at": "2023-10-17T07:14:44Z",
        "body": "For #100678 and and #100640",
        "comments": 4
    },
    {
        "merged": false,
        "additions": 29,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-16T10:27:24Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Provide a facility to supply the primary term for the engine for a more precise comparison of generations. Deprecate existing `addSegmentGenerationListener` and `waitForSegmentGeneration` methods\r\n\r\nPrerequisite for https://github.com/elastic/elasticsearch/pull/99752",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 7,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-16T10:13:07Z",
        "closed_at": "2023-10-16T11:07:55Z",
        "merged_at": "2023-10-16T11:07:55Z",
        "body": "Backports the following commits to 8.11:\n - [ML] Use correct writable name for model assignment metadata in mixed cluster (#100886)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-16T10:11:58Z",
        "closed_at": "2023-10-16T10:54:29Z",
        "merged_at": "2023-10-16T10:54:29Z",
        "body": "Backports the following commits to 8.10:\n - [TEST] Assert that both time-series indexes are created (#100885)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-16T10:11:43Z",
        "closed_at": "2023-10-16T12:04:54Z",
        "merged_at": "2023-10-16T12:04:54Z",
        "body": "Backports the following commits to 8.11:\n - [TEST] Assert that both time-series indexes are created (#100885)",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 261,
        "deletions": 28,
        "changed_files": 22,
        "created_at": "2023-10-16T10:10:57Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Relates to https://github.com/elastic/elasticsearch/issues/97916\r\n\r\nIntroduces a Executor parameter (and field) to `TransportAction`, and updates its `execute()` method to fork using the executor if needed.\r\nAn additional method `executeDirect` is added so inheritors can have the possibility to bypass forking and keep running on the current executor, e.g. if they have already (e.g.  `HandledTransportAction`).\r\nClients like NodeClient will then do not need to worry about forking, as it will be done by `TransportAction` directly when `execute()` is called.\r\n\r\nProvisionally all classes are updated to accept the direct executor, so behaviour is largerly unchanged (except of `HandledTransportAction`, where we already propagate the executor).\r\nA follow up step would be to revise  `TransportAction` implementations overriding `doExecute` to fork on a different executor (in order to work around https://github.com/elastic/elasticsearch/issues/97916) and simplify them.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 328,
        "deletions": 18,
        "changed_files": 32,
        "created_at": "2023-10-16T10:04:11Z",
        "closed_at": "2023-10-18T11:44:33Z",
        "merged_at": "2023-10-18T11:44:33Z",
        "body": "Fixes https://github.com/elastic/elasticsearch/issues/100555\r\n\r\nESQL [by default](https://github.com/elastic/elasticsearch/pull/99816) adds an implicit `LIMIT 500` to queries that do not define a limit. Since this can be confusing for the end user, with this PR we also add a warning to the response, making this default clear and explicit.\r\n\r\n",
        "comments": 4
    },
    {
        "merged": false,
        "additions": 82,
        "deletions": 25,
        "changed_files": 10,
        "created_at": "2023-10-16T10:00:49Z",
        "closed_at": "2023-10-17T15:21:05Z",
        "merged_at": null,
        "body": "The metric is called `elasticsearch.blob_cache.miss_that_triggered_read_from_blob_store` it's a `LongCounter` and is incremented if there is a cache miss reading from blob cache that triggers a read from blob store.\r\nFor tests we are passing a `Meter.NOOP` while in production code we are using the meter passed in the `TelemetryProvider` at `SearchableSnapshot::createComponents`.\r\nWe choose to prefix the metric name with `elasticsearch.blob_cache` to have it in line with this [PR](https://github.com/elastic/elasticsearch/pull/100570).",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 114,
        "deletions": 302,
        "changed_files": 18,
        "created_at": "2023-10-16T09:42:27Z",
        "closed_at": "2023-10-16T15:46:01Z",
        "merged_at": "2023-10-16T15:46:01Z",
        "body": null,
        "comments": 1
    },
    {
        "merged": true,
        "additions": 10,
        "deletions": 3,
        "changed_files": 3,
        "created_at": "2023-10-16T09:14:49Z",
        "closed_at": "2023-10-16T10:09:33Z",
        "merged_at": "2023-10-16T10:09:33Z",
        "body": "Backports the following commits to 8.11:\n - Consistent scores for multi-term SourceConfirmedTestQuery (#100846)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 64,
        "changed_files": 2,
        "created_at": "2023-10-16T08:55:33Z",
        "closed_at": "2023-10-16T11:28:47Z",
        "merged_at": "2023-10-16T11:28:47Z",
        "body": "Reverts elastic/elasticsearch#100794\r\n\r\nThe current matcher fails in serverless because the YAML framework uses NodeInfo - and that still returns Version.CURRENT,\r\n\r\nIn order for this to work, we need to merge:\r\n- https://github.com/elastic/elasticsearch/pull/100868 (to make es tests pass without too many issues due to Version.CURRENT -> Build.current().version() change).\r\n- https://github.com/elastic/elasticsearch/pull/100746 (to make NodeInfo return the \"current\" version - Build.current().version() - that will make the matcher correct on serverless)\r\n\r\nWill re-apply this PR once this chain of merges happen.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 3,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-16T08:52:02Z",
        "closed_at": "2023-10-16T10:07:41Z",
        "merged_at": "2023-10-16T10:07:41Z",
        "body": "Relates #99422",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 7,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-16T08:35:29Z",
        "closed_at": "2023-10-16T10:10:05Z",
        "merged_at": "2023-10-16T10:10:05Z",
        "body": "`TrainedModelAssignmentMetadata` was introduced in version 8.3, in a mixed cluster there are many checks to ensure that the new named writable is not used before the cluster is fully upgraded. However, there is one case where the detail about whether to use the old or new named writable is forgotten and the new one used by default. As older nodes cannot read the new writable this can cause a node failure during a rolling upgrade with the error\r\n```\r\njava.lang.Exception: java.lang.AssertionError: java.lang.IllegalArgumentException: Unknown NamedWriteable [org.elasticsearch.cluster.metadata.Metadata$Custom][trained_model_assignment]\r\n```\r\n\r\nFor #100371",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-16T08:23:36Z",
        "closed_at": "2023-10-16T10:10:47Z",
        "merged_at": "2023-10-16T10:10:47Z",
        "body": "Verify that there are no failures to create the expected indexes in field_caps/time_series tests.\r\n\r\nThis is also affected by the fix for showing the synthetic source, #98808. This can trigger an assert in older versions as the mapping they produce (without synthetic source) doesn't match the one they may get from the master, if the latter is in version 8.10+.\r\n\r\nFixes #100882",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 212,
        "deletions": 140,
        "changed_files": 15,
        "created_at": "2023-10-16T07:39:56Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This commit extracts `NodesStatsMetrics` to a top-level class from `NodesStatsRequest`. `NodesStatsMetrics` is a container that encapsulates the necessary information needed to indicate which node stats is requested.\r\n\r\nRelates #100878 ",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 142,
        "deletions": 7,
        "changed_files": 10,
        "created_at": "2023-10-16T06:44:45Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Introduce new method in BytesReference to copy a subset of the underlying bytes:\r\n\r\n```\r\n    /**\r\n     * Make a copy the bytes from the {@code from} index up to {@code length}. The copy does not\r\n     * contain a direct reference to the internal pages.\r\n     */\r\n    BytesReference deepCopy(int from, int length);\r\n```\r\n\r\nThe output is the same as the slice method but instead of having a reference to the underlying pages, this method creates totally new pages to hold the result.\r\n\r\nNote that you can do the same by copying a BytesReference into another using the internal iterator for accessing the pages but this method should be much faster as it copy pages using aligned boundaries.\r\n",
        "comments": 4
    },
    {
        "merged": false,
        "additions": 170,
        "deletions": 37,
        "changed_files": 28,
        "created_at": "2023-10-16T06:18:02Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Closes #90631",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-15T18:40:45Z",
        "closed_at": "2023-10-16T13:04:33Z",
        "merged_at": "2023-10-16T13:04:33Z",
        "body": "We mostly run our tests with less than 1G of heap per JVM. This means that we will use the unpooled Netty allocator in most tests, losing us a lot of leak coverage in internal cluster tests (mostly for inbound buffers). Unless otherwise specified by tests, we should force the use of our standard allocator by default to get a higher chance of catching leaks in internalClusterTests in particular.\r\n\r\nNoticed this when testing pooling `SearchHit` source bytes and not getting any failures on obvious leaks.",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 65,
        "deletions": 63,
        "changed_files": 2,
        "created_at": "2023-10-15T15:54:50Z",
        "closed_at": "2023-10-16T05:05:24Z",
        "merged_at": "2023-10-16T05:05:24Z",
        "body": "Rather than sending a nodes-info request to the local node via its\r\ntransport service, we should use the `Client` to invoke the action\r\ndirectly.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 222,
        "deletions": 18,
        "changed_files": 9,
        "created_at": "2023-10-15T05:17:51Z",
        "closed_at": "2023-10-16T22:46:32Z",
        "merged_at": "2023-10-16T22:46:32Z",
        "body": "In certain scenarios, a field can be mapped both as a primitive and\r\n object, causing it to be marked as unsupported, losing any potential\r\n subfields that might have been discovered before.\r\nThis commit preserve them to avoid subfields from being incorrectly\r\n reported as missing.\r\n\r\nFix #100869",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 33,
        "deletions": 2,
        "changed_files": 2,
        "created_at": "2023-10-15T04:06:33Z",
        "closed_at": "2023-10-16T13:31:22Z",
        "merged_at": "2023-10-16T13:31:21Z",
        "body": "```json\r\n\"node_failures\": [\r\n  {\r\n    \"type\": \"failed_node_exception\",\r\n    \"reason\": \"Failed node [qpdSPb3yQkuDlsI9TH7a2g]\",\r\n    \"node_id\": \"qpdSPb3yQkuDlsI9TH7a2g\",\r\n    \"caused_by\": {\r\n      \"type\": \"transport_serialization_exception\",\r\n      \"reason\": \"Failed to deserialize response from handler\",\r\n      \"caused_by\": {\r\n        \"type\": \"illegal_argument_exception\",\r\n        \"reason\": \"Unknown NamedWriteable [org.elasticsearch.compute.operator.Operator$Status][topn]\"\r\n      }\r\n    }\r\n  }\r\n]\r\n```\r\n\r\nI hit this error when trying to retrieve ESQL tasks. The issue is that we forget to register NamedWritable for the status of TopN.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 161,
        "deletions": 19,
        "changed_files": 8,
        "created_at": "2023-10-14T21:02:02Z",
        "closed_at": "2023-10-17T13:59:14Z",
        "merged_at": "2023-10-17T13:59:14Z",
        "body": "Painless sandboxes some errors from Java for which it can recover. These\r\nerrors are wrapped within a ScriptException. However, retaining the\r\nerror as a cause can be confusing when walking the error chain. This\r\ncommit wraps the error so that the real error type does not appear,\r\nbut maintains the same error message in xcontent serialized form.\r\n",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 103,
        "deletions": 61,
        "changed_files": 6,
        "created_at": "2023-10-14T14:57:52Z",
        "closed_at": "2023-10-17T03:23:03Z",
        "merged_at": "2023-10-17T03:23:03Z",
        "body": "The build version is made up of a few parts in non-release builds. Both the snapshot and pre-release qualifiers are appended to it. These qualifiers used to be part of Version, but in 7.0 the qualifiers were made to be found only in the build info. The Build class retains these qualifiers through the compile ES version extracted from the server jar at runtime.\r\n\r\nBuild.qualifiedVersion() is suppose to provide the fully qualified version, including snapshot and pre-release qualifiers. Yet Build.version() also includes this information; there is no distinction since the qualifier was moved to be only in the build info.\r\n\r\nThis commit separates the pre-release qualifier from the version. It maintains bwc in talking to older nodes, passing the fully qualified version there, but in current nodes splits out the pre-release qualifier into a new member of Build.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 336,
        "deletions": 817,
        "changed_files": 110,
        "created_at": "2023-10-14T08:58:33Z",
        "closed_at": "2023-10-17T08:27:38Z",
        "merged_at": "2023-10-17T08:27:37Z",
        "body": "There are no remote invocations of any actions derived from\r\n`TransportNodesAction` so there is no need to register the top-level\r\naction with the `TransportService`, and that means that all the code\r\nrelated to de/serialization of the top-level request and response is\r\nunused and can be removed.\r\n\r\nRelates #100111\r\nRelates #100878",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 253,
        "deletions": 59,
        "changed_files": 11,
        "created_at": "2023-10-14T04:41:42Z",
        "closed_at": "2023-10-17T05:30:04Z",
        "merged_at": "2023-10-17T05:30:04Z",
        "body": "Data nodes can fold a plan (typically for missing fields) to an empty, local relationship as a logical optimization.\r\nHowever the context, such as whether the output is an aggregation or not gets lost which is problematic during physical execution since the upstream aggregation expects the intermediate states while the aggregation returns the final ones.\r\n\r\nConsider the query: from index | where field is not null | stats c = count()\r\n\r\nOn shards where the field in the filter does not exist, the filter gets nullified which folds the whole _local_ plan to a LocalRelation returning c as 0.\r\nHowever the data node should return the intermediate aggregation states (count and seen) - otherwise the query fails with an internal error (NPE) since the expected channel by the exchange is not found.\r\n\r\nFix #100807",
        "comments": 4
    },
    {
        "merged": false,
        "additions": 123,
        "deletions": 40,
        "changed_files": 4,
        "created_at": "2023-10-14T01:35:15Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This PR addresses several issues identified after the port from Kibana in https://github.com/elastic/elasticsearch/pull/99091:\r\n\r\n- refactor `createFrameGroupId` into its own class so other API actions can use it\r\n- check if the source filename is empty and use `fileID`+`functionName` in ID instead of `exeFilename`+`functionName`\r\n- create ID by hashing the respective metadata attributes\r\n- trim the source filename so that only the basename and its parent directory is used if available",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 108,
        "deletions": 42,
        "changed_files": 6,
        "created_at": "2023-10-14T00:55:32Z",
        "closed_at": "2023-10-17T14:37:22Z",
        "merged_at": "2023-10-17T14:37:22Z",
        "body": "Relates to https://github.com/elastic/kibana/issues/165958\r\n\r\nThis PR uses new screenshots that are automated in https://github.com/elastic/kibana/pull/168900.\r\n\r\nIt updates [Generating alerts for anomaly detection jobs](https://www.elastic.co/guide/en/machine-learning/master/ml-configuring-alerts.html) to reflect the new types of action frequencies available in anomaly detection alert rules.\r\n\r\nSince anomaly detection jobs health rules do not have the same options, I've changed the layout of the page such that the \"actions\" sections are nested under the rule types. Likewise, since transform health rules do not have the same options, I've removed the tagged region that was re-using content across these pages.\r\n\r\n@szabosteve If you think I should move the rule-specific action variable sections under the rule-specific sections too or just split this into two separate pages, lmk!",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 4,
        "changed_files": 2,
        "created_at": "2023-10-13T22:27:47Z",
        "closed_at": "2023-10-16T19:50:32Z",
        "merged_at": "2023-10-16T19:50:32Z",
        "body": "The test fails due to out-of-order documents in the enrich index. This can occur when replicas are initializing during indexing. To avoid this, we just need to ensure there are no initializing shards before starting indexing and disable shard relocations.\r\n\r\nCloses #99807",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 78,
        "deletions": 2,
        "changed_files": 3,
        "created_at": "2023-10-13T21:05:38Z",
        "closed_at": "2023-10-16T16:02:43Z",
        "merged_at": "2023-10-16T16:02:43Z",
        "body": "DocumentParsingObserver expects the index name to be non-null. However the way it is used in IngestService, it can be null. For example in this bulk request (https://github.com/elastic/elasticsearch/blob/main/modules/ingest-common/src/yamlRestTest/resources/rest-api-spec/test/ingest/70_bulk.yml#L209) the value of `indexRequest` in IngestService is null because that is referring to the upsert within the update, and we do not copy the index name down to it. This change pulls the index name off of `actionRequest` instead, where it is not null.\r\nRelates to #97961",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 54,
        "deletions": 28,
        "changed_files": 2,
        "created_at": "2023-10-13T20:38:29Z",
        "closed_at": null,
        "merged_at": null,
        "body": "# Backport\n\nThis will backport the following commits from `main` to `7.17`:\n - [[buildkite] Upload build artifact and add to build scan (#100842)](https://github.com/elastic/elasticsearch/pull/100842)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 31,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-13T20:36:13Z",
        "closed_at": "2023-10-13T21:00:01Z",
        "merged_at": "2023-10-13T21:00:00Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.10`:\n - [[buildkite] Upload build artifact and add to build scan (#100842)](https://github.com/elastic/elasticsearch/pull/100842)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 31,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-13T20:36:02Z",
        "closed_at": "2023-10-13T20:59:53Z",
        "merged_at": "2023-10-13T20:59:53Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.11`:\n - [[buildkite] Upload build artifact and add to build scan (#100842)](https://github.com/elastic/elasticsearch/pull/100842)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 222,
        "deletions": 40,
        "changed_files": 1,
        "created_at": "2023-10-13T20:27:40Z",
        "closed_at": "2023-10-16T13:03:16Z",
        "merged_at": "2023-10-16T13:03:16Z",
        "body": "Refactor testRerouteRecovery, pulling out testing of shard recovery\r\nthrottling into separate targeted tests. Now there are two additional\r\ntests, one testing source node throttling, and another testing target\r\nnode throttling. Throttling both nodes at once leads to primarily the\r\nsource node registering throttling, while the target node mostly has\r\nno cause to instigate throttling.\r\n\r\n(cherry picked from commit 323d9366dfa288fea2f78fc28128b456c3d3246e)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 33,
        "deletions": 31,
        "changed_files": 4,
        "created_at": "2023-10-13T20:21:34Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Prior system index descriptors are only used to retrieve mappings, so they can be versioned with the mappings version rather than a node version.",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 149,
        "deletions": 39,
        "changed_files": 2,
        "created_at": "2023-10-13T20:12:42Z",
        "closed_at": "2023-10-16T23:39:33Z",
        "merged_at": "2023-10-16T23:39:33Z",
        "body": "Direct access to the `.enrich-* indices`, which are restricted system indices, should not be granted to users. Instead, ESQL enrich lookup should access these indices using the `enrich_origin` on behalf of the user. With this change, the enrich lookup checks for the `monitor_enrich` cluster privilege before performing the actual lookup with the `enrich_origin`.\r\n\r\nSpin-off from #100724",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 10,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-13T19:52:31Z",
        "closed_at": "2023-10-15T15:50:42Z",
        "merged_at": "2023-10-15T15:50:42Z",
        "body": "We can't assert no leaked blobs here because today the first cleanup\r\nleaves the original `RepositoryData` in place so the second cleanup is\r\nnot a no-op.\r\n\r\nRelates #100718",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 222,
        "deletions": 38,
        "changed_files": 1,
        "created_at": "2023-10-13T19:47:26Z",
        "closed_at": "2023-10-16T13:01:30Z",
        "merged_at": "2023-10-16T13:01:30Z",
        "body": "Backports the following commits to 8.10:\n - Stabilize testRerouteRecovery throttle testing (#100788)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 222,
        "deletions": 38,
        "changed_files": 1,
        "created_at": "2023-10-13T19:46:51Z",
        "closed_at": "2023-10-16T13:00:43Z",
        "merged_at": "2023-10-16T13:00:43Z",
        "body": "Backports the following commits to 8.11:\n - Stabilize testRerouteRecovery throttle testing (#100788)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 24,
        "deletions": 5,
        "changed_files": 9,
        "created_at": "2023-10-13T19:08:52Z",
        "closed_at": "2023-10-16T09:02:30Z",
        "merged_at": "2023-10-16T09:02:30Z",
        "body": "Currently, before performing operations that require the ML internal indices be available we check whether their primary shards are active.\r\n\r\nIn stateless Elasticsearch we need to separately check whether the indices are searchable, as search and indexing shards are separate.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 5,
        "changed_files": 4,
        "created_at": "2023-10-13T18:54:23Z",
        "closed_at": "2023-10-16T08:34:59Z",
        "merged_at": "2023-10-16T08:34:59Z",
        "body": "Currently, before performing operations that require the transform internal index be available we check whether its primary shard is active.\r\n\r\nIn stateless Elasticsearch we need to separately check whether the index is searchable, as search and indexing shards are separate.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 7,
        "changed_files": 2,
        "created_at": "2023-10-13T16:36:12Z",
        "closed_at": "2023-10-13T16:54:44Z",
        "merged_at": "2023-10-13T16:54:44Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.11`:\n - [Fix manage/monitor_enrich documentation (#100781)](https://github.com/elastic/elasticsearch/pull/100781)\n\n<!--- Backport version: 9.3.0 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 16,
        "deletions": 5,
        "changed_files": 3,
        "created_at": "2023-10-13T16:28:10Z",
        "closed_at": "2023-10-13T17:24:32Z",
        "merged_at": "2023-10-13T17:24:32Z",
        "body": "Backports the following commits to 8.11:\n - Fix NullPointerException in RotableSecret (#100779)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 10,
        "deletions": 3,
        "changed_files": 3,
        "created_at": "2023-10-13T16:20:07Z",
        "closed_at": "2023-10-16T09:11:10Z",
        "merged_at": "2023-10-16T09:11:10Z",
        "body": "SourceConfirmedTestQuery uses a QueryVisitor to collect terms from \r\nits inner query to build its internal SimScorer.  It is important to hold these\r\nterms in a consistent order so that when scores for each term are summed,\r\nthe order of summation is the same as it would be for the inner query.  This\r\ncommit changes the call to visit to use a LinkedHashSet to ensure that \r\nterms are iterated in the order in which they are collected.\r\n\r\nFixes #98712",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 10,
        "changed_files": 1,
        "created_at": "2023-10-13T16:18:28Z",
        "closed_at": "2023-10-16T21:35:54Z",
        "merged_at": "2023-10-16T21:35:54Z",
        "body": "I was unable to reproduce, but this test did fail in the last week or so. Ran it many 100s of times and could never reproduce. \r\n\r\nHowever, it seems like we should refresh to ensure things are searchable. This might help the failure.\r\n\r\n\r\ncloses: https://github.com/elastic/elasticsearch/issues/96558",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 31,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-13T15:28:03Z",
        "closed_at": "2023-10-13T20:35:32Z",
        "merged_at": "2023-10-13T20:35:32Z",
        "body": "- Upload build artifact to Buildkite.\r\n- Link to the artifacts from the buildscan\r\n- Add a couple of extra buildscan values",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 11,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-13T15:10:08Z",
        "closed_at": null,
        "merged_at": null,
        "body": "All the flaky failures started occurring after: https://github.com/elastic/elasticsearch/pull/99689\r\n\r\nThis indicates to me that all these tests need re-working due to segment concurrency. In an effort to get coverage back for our testing, concurrency is disabled again so these tests can be unmuted. \r\n\r\ncloses: https://github.com/elastic/elasticsearch/issues/99929\r\n\r\nI verified that the test passes, running 100s of times locally. I added trace logging just in case.",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 220,
        "deletions": 1,
        "changed_files": 5,
        "created_at": "2023-10-13T14:49:43Z",
        "closed_at": null,
        "merged_at": null,
        "body": "when running `gradlew run` it should be possible to quickly setup a fake \r\napm server that will be simply logging received apm agent requests.\r\nThis commits adds a gradle build service that will be run before the RunTask\r\nand will start a simple http server based on https://github.com/elastic/elasticsearch/pull/99786/files#diff-b5adc064f3d08f85b68e329cac1d1a7ec9a6ae5b2c1d52662fa612700d957110\r\n",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 182,
        "deletions": 178,
        "changed_files": 23,
        "created_at": "2023-10-13T14:17:14Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Companion of https://github.com/elastic/elasticsearch/pull/100770\r\n\r\nReplace version parsing + comparisons with pure string equality. \r\nTwo main things are covered here:\r\n- partition nodes in a mixed cluster (new and old nodes)\r\n- move the real Version comparisons to isolated methods or fields, marked as `@Deprecated` or with `//TODO`s, while waiting for features service/API",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 557,
        "deletions": 43,
        "changed_files": 18,
        "created_at": "2023-10-13T14:06:31Z",
        "closed_at": null,
        "merged_at": null,
        "body": "<!--\r\nThank you for your interest in and contributing to Elasticsearch! There\r\nare a few simple things to check before submitting your pull request\r\nthat can help with the review process. You should delete these items\r\nfrom your submission, but they are here to help bring them to your\r\nattention.\r\n-->\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)?\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)?\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`?\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed.\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)?\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.\r\n",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 21,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-13T13:42:50Z",
        "closed_at": "2023-10-13T13:59:49Z",
        "merged_at": "2023-10-13T13:59:49Z",
        "body": "Backports the following commits to 8.10:\n - [Docs] Document a bit more the implicit rollover conditions (#100750)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 21,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-13T13:42:31Z",
        "closed_at": "2023-10-13T14:00:12Z",
        "merged_at": "2023-10-13T14:00:12Z",
        "body": "Backports the following commits to 8.11:\n - [Docs] Document a bit more the implicit rollover conditions (#100750)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 14,
        "deletions": 0,
        "changed_files": 2,
        "created_at": "2023-10-13T13:14:53Z",
        "closed_at": "2023-10-13T14:01:47Z",
        "merged_at": "2023-10-13T14:01:47Z",
        "body": "Improved the ES|QL documentation by adding missing svgs for starts_with and trim functions.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 46,
        "deletions": 0,
        "changed_files": 2,
        "created_at": "2023-10-13T13:12:21Z",
        "closed_at": "2023-10-13T13:53:21Z",
        "merged_at": "2023-10-13T13:53:21Z",
        "body": "This adds a test for dynamic dims update mapping merges.\r\n\r\nAlso, this adds logging to help investigate a periodically failing test.\r\n\r\nrelated to: https://github.com/elastic/elasticsearch/issues/100502",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-13T12:58:04Z",
        "closed_at": "2023-10-13T13:43:15Z",
        "merged_at": "2023-10-13T13:43:15Z",
        "body": "Backports the following commits to 8.10:\n - Compute shardStateId before addAbortListener (#100809)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-13T12:57:49Z",
        "closed_at": "2023-10-13T13:59:52Z",
        "merged_at": "2023-10-13T13:59:52Z",
        "body": "Backports the following commits to 8.11:\n - Compute shardStateId before addAbortListener (#100809)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-13T12:38:18Z",
        "closed_at": "2023-10-13T13:52:03Z",
        "merged_at": "2023-10-13T13:52:03Z",
        "body": "Backports the following commits to 8.11:\r\n\r\n* [TEST] Accept fielddata memory size 0 in terms agg with global_ordinals execution hint (#100756)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 53,
        "deletions": 16,
        "changed_files": 4,
        "created_at": "2023-10-13T12:28:20Z",
        "closed_at": "2023-10-13T16:06:10Z",
        "merged_at": "2023-10-13T16:06:10Z",
        "body": "A task cancelled exception has REST status 400, which makes it irrecoverable as far as transforms is concerned. This means that a transform that suffers such an exception will fail without doing any retries. This is bad, because a search can fail with a task cancelled exception if one of its lower level phases suffers a circuit breaker exception. We want transforms to retry in the event of there temporarily not being sufficient memory for a search.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 3,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-13T12:25:51Z",
        "closed_at": "2023-10-13T12:55:53Z",
        "merged_at": "2023-10-13T12:55:53Z",
        "body": "Follow-up on https://github.com/elastic/elasticsearch/pull/100805, overrode a pre-existing skip.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 128,
        "deletions": 29,
        "changed_files": 7,
        "created_at": "2023-10-13T12:18:59Z",
        "closed_at": "2023-10-18T07:47:55Z",
        "merged_at": "2023-10-18T07:47:55Z",
        "body": "In Elasticsearch we sometimes use geotile grid using arithmetic operations, for example calling GeoTileUtils#getXTile nd sometimes we resolve things geometrically by calling  GeoTileUtils#toBoundingBox. It is easy to prove that the geometric solution is equivalent to the arithmetic solution until zoom 19 using lucene encoding scheme for geo. After that, we can observe instabilities and solutions are not consistent.\r\n\r\nIn order to fix that we added some logic to GeoTileUtils#toBoundingBox that make sure the generated bounding boxes are consistent with the arithmetic solution and hence we can use both approaches indistintable, regardless the zoom level.\r\n\r\nfixes https://github.com/elastic/elasticsearch/issues/92611\r\nfixes https://github.com/elastic/elasticsearch/issues/95574",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 44,
        "deletions": 44,
        "changed_files": 2,
        "created_at": "2023-10-13T12:13:40Z",
        "closed_at": "2023-10-13T12:31:05Z",
        "merged_at": "2023-10-13T12:31:05Z",
        "body": "Backports the following commits to 8.10:\n - [Query Rules] clarify query rules API documentation (#100732)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 44,
        "deletions": 44,
        "changed_files": 2,
        "created_at": "2023-10-13T12:13:22Z",
        "closed_at": "2023-10-13T12:31:03Z",
        "merged_at": "2023-10-13T12:31:03Z",
        "body": "Backports the following commits to 8.11:\n - [Query Rules] clarify query rules API documentation (#100732)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 2,
        "changed_files": 2,
        "created_at": "2023-10-13T12:10:17Z",
        "closed_at": "2023-10-13T12:26:56Z",
        "merged_at": "2023-10-13T12:26:56Z",
        "body": "Backports the following commits to 8.11:\n - Restore version skipping for position fields (#100817)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-13T11:56:44Z",
        "closed_at": "2023-10-13T12:47:38Z",
        "merged_at": "2023-10-13T12:47:38Z",
        "body": "Tried locally 500+ times and is not failing. Probably resolved.\r\ncloses #99519",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 23,
        "deletions": 0,
        "changed_files": 2,
        "created_at": "2023-10-13T11:34:25Z",
        "closed_at": "2023-10-13T11:52:19Z",
        "merged_at": "2023-10-13T11:52:19Z",
        "body": "(cherry picked from commit 78ac64f013275c8507f462a7802e27380540cdc4)\r\nSigned-off-by: Andrei Dan <andrei.dan@elastic.co>\r\n\r\nBackport of #100772",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 23,
        "deletions": 0,
        "changed_files": 2,
        "created_at": "2023-10-13T11:32:36Z",
        "closed_at": "2023-10-13T11:49:31Z",
        "merged_at": "2023-10-13T11:49:31Z",
        "body": "(cherry picked from commit 78ac64f013275c8507f462a7802e27380540cdc4)\r\nSigned-off-by: Andrei Dan <andrei.dan@elastic.co>\r\n\r\nBackport of #100772",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 2,
        "changed_files": 2,
        "created_at": "2023-10-13T11:14:09Z",
        "closed_at": "2023-10-13T12:08:50Z",
        "merged_at": "2023-10-13T12:08:50Z",
        "body": "Follow-up on #100805, overrode a pre-existing skip.",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 117,
        "deletions": 2,
        "changed_files": 3,
        "created_at": "2023-10-13T11:08:15Z",
        "closed_at": "2023-10-16T13:44:36Z",
        "merged_at": null,
        "body": "With this PR we propose to address #57809 by checking if the policy that we are waiting for applies to the index that we are going to delete.\r\n\r\nWe also introduce a new safety check, namely, the last successful run of the SLM policy needs to have happened after the latest modification time. From fixing the index pattern but then SLM's last successful run was before this modification meaning this index is still not included.\r\n\r\nFixes: #57809 ",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 80,
        "deletions": 20,
        "changed_files": 17,
        "created_at": "2023-10-13T10:52:05Z",
        "closed_at": "2023-10-13T11:14:42Z",
        "merged_at": "2023-10-13T11:14:42Z",
        "body": "Backports the following commits to 8.10:\r\n\r\n[TEST] Mute all tsdb tests in mixedClusterTests, for versions 8.7 - 8.10 (#100805)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 80,
        "deletions": 20,
        "changed_files": 17,
        "created_at": "2023-10-13T10:34:17Z",
        "closed_at": "2023-10-13T10:53:06Z",
        "merged_at": "2023-10-13T10:53:06Z",
        "body": "Backports the following commits to 8.11:\n - [TEST] Mute all tsdb tests in mixedClusterTests, for versions 8.7 - 8.10 (#100805)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 40,
        "deletions": 2,
        "changed_files": 3,
        "created_at": "2023-10-13T10:17:12Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Currently, if we use `ParentTaskAssigningClient` and want to spawn a remote request, we need to:\r\n1. get remote client using `.getRemoteClusterClient` method\r\n2. call `.setParentTask` on the remote request method manually\r\n\r\nThis PR makes it so the remote client obtained by calling `.getRemoteClusterClient` method is also a `ParentTaskAssigningClient` so there is no need to call `.setParentTask` on the child request anymore.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 10,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-13T09:50:46Z",
        "closed_at": "2023-10-13T10:30:56Z",
        "merged_at": "2023-10-13T10:30:56Z",
        "body": "The issue with the failing test was that we're having an assertion within the test suite that relies on 3 randomly generated integers. The assertion states that the sum should be a strictly positive number, whereas the integers are drawn from the `[0, 10]` range. \r\n\r\nSince this seems to be only test-related, and IIUC is not an actual issue that we might have to deal with, in this PR we are adding small variance to one of the int variables in case all of them are 0 (+unmuting the test itself). \r\n\r\nCloses https://github.com/elastic/elasticsearch/issues/98706",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 288,
        "deletions": 87,
        "changed_files": 7,
        "created_at": "2023-10-13T09:34:47Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This does not compile (yet) and requires some more identical work to replace minimumVersion() and relative checks, but before proceeding I wanted to show you this and understand if it's worth for me to continue.\r\n\r\nContext: I started working on this class as part of NodeInfo Version-related refactoring, trying to isolate Version.fromString and why is it needed.\r\n\r\nThe idea is to move any version check to a capability check (a boolean method on a `NodeFeatures` interface - which can be probably renamed to `TestNodeFeatures` for clarity). The interface now is implemented with Version checks, but those can be moved (at once or progressively) to feature-based checks once we have them exposed via an API (maybe NodeInfo itself, I think it could make sense).\r\nAlso, it allows us to do the refactoring in 2 steps: change the code structure but keep it essentially the same (this) + in the future do a change to one single point - reducing risk to introduce errors.\r\n",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 23,
        "deletions": 9,
        "changed_files": 1,
        "created_at": "2023-10-13T09:24:21Z",
        "closed_at": "2023-10-13T10:05:31Z",
        "merged_at": "2023-10-13T10:05:31Z",
        "body": "The results of these tests can vary in the last significant digit depending on hardware and maths library optimisations.\r\n\r\nTherefore we need to tolerate small failures in results to avoid spurious failures.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-13T08:59:30Z",
        "closed_at": "2023-10-13T12:56:45Z",
        "merged_at": "2023-10-13T12:56:45Z",
        "body": "It is not valid to call `SnapshotIndexCommit#indexCommit()` if the\r\nsnapshot is aborted, so we must compute `shardStateId` before adding the\r\nabort listener.\r\n\r\nCloses #99477",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 272,
        "deletions": 144,
        "changed_files": 26,
        "created_at": "2023-10-13T08:55:27Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This PR makes a few changes in order to make internal actions `GetCheckpointAction` and `GetCheckpointNodeAction` cancellable:\r\n1. check `task.isCancelled` bit at every iteration of the loop through the nodes (`GetCheckpointAction`) and through the shards (`GetCheckpointNodeAction`).\r\n2. pass proper task (i.e.: `_stats` action task instead of persistent task) to the methods that call `GetCheckpointAction` action. This way, when `_stats` action gets cancelled, the underlying `GetCheckpointAction` action will get cancelled too\r\n3. Use `ParentTaskAssigningClient` type explicitly in method signatures so that it is apparent that this kind of client is used consistently throughout the transform codebase\r\n4. Make `ParentTaskAssigningClient.getRemoteClient` method return a `ParentTaskAssigningClient`. Before, the remote child tasks were disconnected from the parent. This change is implemented in a separate PR (https://github.com/elastic/elasticsearch/pull/100813) which must be merged first.\r\n\r\nRelates https://github.com/elastic/elasticsearch/issues/100494",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 1112,
        "deletions": 231,
        "changed_files": 122,
        "created_at": "2023-10-13T08:35:12Z",
        "closed_at": "2023-10-17T15:36:14Z",
        "merged_at": "2023-10-17T15:36:14Z",
        "body": "Restructures the ES|QL documentation, modelled after the SQL and EQL docs.\r\n\r\n- Moves commands, functions, and operator to one section, with an [overview page](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-commands-functions-operators.html) that lists all of them. Instead of having each command/function on a separate page, they're now listed on a single page per category.\r\n- Adds [reference docs for the query API](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-query-api.html) and an [overview of the API](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-rest.html).\r\n- Breaks out \"[Limitations](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-limitations.html)\" into its own page.\r\n- Moves syntax, multivalued fields and metadata fields pages under a \"[Language](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-language.html)\" page.\r\n- Adds placeholders for \"Getting started\" and \"Using ES|QL in Kibana\" pages.\r\n- Proposes a standard layout for commands and functions, implemented in this PR for [ACOS](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-math-functions.html#esql-acos), [CASE](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-conditional-functions-and-expressions.html#esql-case), and [DATE_PARSE](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-date-time-functions.html#esql-date_parse).\r\n\r\n**Notes for reviewers:**\r\n\r\nThis PR changes a lot of files. Most changes are trivial, but please take a look at:\r\n\r\n- Is the [REST API reference](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-query-api.html) and the [overview of the API](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-rest.html) complete/correct?\r\n- Is [the categorization of functions and operators](https://elasticsearch_100806.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-commands-functions-operators.html) correct? For example, I wasn't sure how to categorize `AUTO_BUCKET`, and I've put it under \"Date-time functions\".",
        "comments": 7
    },
    {
        "merged": true,
        "additions": 80,
        "deletions": 26,
        "changed_files": 18,
        "created_at": "2023-10-13T08:27:23Z",
        "closed_at": "2023-10-13T10:33:04Z",
        "merged_at": "2023-10-13T10:33:04Z",
        "body": "These tests are affected by the fix for showing the synthetic source, #98808. This can trigger an assert in older versions as the mapping they produce (without synthetic source) doesn't match the one they may get from the master, if the latter is in version 8.10+.\r\n\r\nFixes #100562",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 80,
        "deletions": 13,
        "changed_files": 7,
        "created_at": "2023-10-13T08:23:22Z",
        "closed_at": "2023-10-13T09:05:15Z",
        "merged_at": "2023-10-13T09:05:15Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Properly handle multi-values in fold() and date math (#100766)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 36,
        "deletions": 30,
        "changed_files": 1,
        "created_at": "2023-10-13T08:08:48Z",
        "closed_at": "2023-10-13T09:45:56Z",
        "merged_at": "2023-10-13T09:45:56Z",
        "body": "Makes it a little easier to follow the three steps of processing a\r\ndelete with the modern repo format, and fixes some incorrect comments.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-13T07:51:56Z",
        "closed_at": "2023-10-13T14:42:10Z",
        "merged_at": "2023-10-13T14:42:10Z",
        "body": "For investigating #100371, revert once #100371 is resolved",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 889,
        "deletions": 30,
        "changed_files": 13,
        "created_at": "2023-10-13T07:06:28Z",
        "closed_at": "2023-10-13T07:24:19Z",
        "merged_at": "2023-10-13T07:24:19Z",
        "body": "Backports the following commits to 8.11:\n - [DOCS] Migrate Behavioral Analytics docs to ES ref (#100704)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 11,
        "deletions": 14,
        "changed_files": 1,
        "created_at": "2023-10-13T07:02:56Z",
        "closed_at": "2023-10-13T08:00:07Z",
        "merged_at": "2023-10-13T08:00:07Z",
        "body": null,
        "comments": 1
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 3,
        "changed_files": 1,
        "created_at": "2023-10-13T06:49:06Z",
        "closed_at": "2023-10-13T08:04:02Z",
        "merged_at": "2023-10-13T08:04:02Z",
        "body": "In some cases it takes more than 10s for the test cluster to move from \"yellow\" health to having a valid basic license.\r\n\r\nThis is clearly ridiculous, however it's not a problem with the test itself - it's related to the number of templates being installed and the performance on the CI worker.\r\n\r\nThere are 3 possible options:\r\n- Leave the test running and failing due to something outside of its control\r\n- Mute the test indefinitely\r\n- Increase the timeout when waiting for the license to be generated\r\n\r\nOf those options, the last one is the least-worst.\r\n\r\nRelates: #97487\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 64,
        "deletions": 12,
        "changed_files": 2,
        "created_at": "2023-10-13T06:30:24Z",
        "closed_at": "2023-10-16T07:34:17Z",
        "merged_at": "2023-10-16T07:34:17Z",
        "body": "Spinoff from https://github.com/elastic/elasticsearch/pull/100770\r\n- Makes version matching work even when it includes `-SNAPSHOT` (we provisionally have mixed use of Build.version() and Version.toString() for the Rest APIs)\r\n- Makes `version: current` work with non-semantic versions, moving it to a string.equals comparison",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 253,
        "deletions": 26,
        "changed_files": 4,
        "created_at": "2023-10-13T05:46:38Z",
        "closed_at": "2023-10-17T08:08:26Z",
        "merged_at": "2023-10-17T08:08:26Z",
        "body": "Each per-index process during snapshot deletion takes some nonzero\r\namount of working memory to hold the relevant snapshot IDs and metadata\r\ngenerations etc. which we can keep under tighter limits and release\r\nsooner if we limit the number of per-index processes running\r\nconcurrently. That's what this commit does.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 22,
        "deletions": 0,
        "changed_files": 3,
        "created_at": "2023-10-13T05:32:19Z",
        "closed_at": "2023-10-13T06:27:09Z",
        "merged_at": "2023-10-13T06:27:09Z",
        "body": "Backports the following commits to 8.11:\n - Grant editor and viewer access to profiling (#100594)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 24,
        "deletions": 18,
        "changed_files": 2,
        "created_at": "2023-10-13T04:59:39Z",
        "closed_at": "2023-10-13T07:11:57Z",
        "merged_at": "2023-10-13T07:11:57Z",
        "body": "This commit moves the tracking of the number & size of deleted blobs\r\nduring cleanup to the top level so that in future they might track the\r\nshard-level deletions too.\r\n\r\nRelates #56660",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 3,
        "changed_files": 1,
        "created_at": "2023-10-13T04:46:25Z",
        "closed_at": "2023-10-13T07:12:26Z",
        "merged_at": "2023-10-13T07:12:26Z",
        "body": "In `SnapshotStressTestsIT` we block full-cluster restarts while deleting\r\nand re-registering the repository, but a single node might be restarting\r\nand that could cause the re-registration to fail during verification.\r\nWith this commit we skip verification if we could not block all nodes\r\nfrom restarting.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-12T23:55:52Z",
        "closed_at": "2023-10-13T16:59:03Z",
        "merged_at": "2023-10-13T16:59:03Z",
        "body": "Turns out creating spotless tasks is actually quite costly. It requires reaching out to public P2 repositories and eagerly resolving dependencies. We should avoid doing so by using lazy-task configuration APIs here.\r\n\r\nCloses https://github.com/elastic/elasticsearch/issues/100753",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 222,
        "deletions": 38,
        "changed_files": 1,
        "created_at": "2023-10-12T23:40:26Z",
        "closed_at": "2023-10-13T19:45:26Z",
        "merged_at": "2023-10-13T19:45:26Z",
        "body": "Refactor testRerouteRecovery, pulling out testing of shard recovery\r\nthrottling into separate targeted tests. Now there are two additional\r\ntests, one testing source node throttling, and another testing target\r\nnode throttling. Throttling both nodes at once leads to primarily the\r\nsource node registering throttling, while the target node mostly has\r\nno cause to instigate throttling.\r\n\r\nCloses #99941",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-12T23:22:37Z",
        "closed_at": "2023-10-13T00:02:06Z",
        "merged_at": "2023-10-13T00:02:06Z",
        "body": "Backports the following commits to 7.17:\n - Disable BWC tests in encryption at rest CI job (#100784)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-12T23:21:51Z",
        "closed_at": "2023-10-13T00:01:23Z",
        "merged_at": "2023-10-13T00:01:23Z",
        "body": "Backports the following commits to 8.11:\n - Disable BWC tests in encryption at rest CI job (#100784)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-12T23:21:29Z",
        "closed_at": "2023-10-13T00:03:19Z",
        "merged_at": "2023-10-13T00:03:19Z",
        "body": "Backports the following commits to 8.10:\n - Disable BWC tests in encryption at rest CI job (#100784)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-12T22:36:49Z",
        "closed_at": "2023-10-12T23:19:53Z",
        "merged_at": "2023-10-12T23:19:53Z",
        "body": "Similarly to #100643, we don't need to run BWC tests in this CI job. They are particularly costly to run and are extra susceptible to timeouts in this build.",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 437,
        "deletions": 1,
        "changed_files": 5,
        "created_at": "2023-10-12T21:38:12Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Allow mv_expand to push down limit and project past it.\r\nHave the limit before mv_expand to not override the limit after it, since mv_expand is special from this point of view in the sense that it creates more rows than the original ones as defined by the `from` command.\r\n\r\nFixes https://github.com/elastic/elasticsearch/issues/99971\r\nFixes https://github.com/elastic/elasticsearch/issues/100774",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 7,
        "changed_files": 2,
        "created_at": "2023-10-12T20:18:09Z",
        "closed_at": "2023-10-13T16:29:48Z",
        "merged_at": "2023-10-13T16:29:48Z",
        "body": "`manage_enrich` is a cluster privilege, not a built in role. This commit remove `manage_enrich` from the role documentation. \r\n`manage_enrich` is already documented as a cluster privilege. \r\nThis commit also makes mention of the `monitor_enrich` introduced in https://github.com/elastic/elasticsearch/pull/99646.\r\n\r\nrelated: https://github.com/elastic/elasticsearch/pull/85877",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 282,
        "deletions": 129,
        "changed_files": 10,
        "created_at": "2023-10-12T18:24:12Z",
        "closed_at": "2023-10-12T19:06:09Z",
        "merged_at": "2023-10-12T19:06:09Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Copy blocks on expand (#100778)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 16,
        "deletions": 5,
        "changed_files": 3,
        "created_at": "2023-10-12T17:48:28Z",
        "closed_at": "2023-10-13T16:25:01Z",
        "merged_at": "2023-10-13T16:25:01Z",
        "body": "This commit fixes two things:\r\n1) `RotatableSecret#matches` could throw a `NullPointerException` when the current secret is null but the prior secret is not. \r\n2) `RotatableSecret#checkExpired` would not expire a prior secret when checking the same millisecond the prior secret was due to expire.\r\n\r\nBoth of these would cause intermittent test failures, the first based on randomization and the second based on timing.\r\n\r\nFixes #99759",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 282,
        "deletions": 129,
        "changed_files": 10,
        "created_at": "2023-10-12T16:32:00Z",
        "closed_at": "2023-10-12T18:22:54Z",
        "merged_at": "2023-10-12T18:22:54Z",
        "body": "Until we get lovely reference tracking, let's copy blocks when \"expanding\" them. For now, that's simple and it works and helps make memory tracking cleaner. I expect we won't copy forever. We can likely share the array once we get reference tracking. But for now, let's copy!\r\n\r\nCloses #100548\r\n",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 273,
        "deletions": 8,
        "changed_files": 5,
        "created_at": "2023-10-12T15:13:18Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Quoting from the original ticket:\r\n\r\n\r\n> We discussed this yesterday and a potential solution here is to report the fully and partially mounted indices health only if the source indices are missing (or red themselves).\r\ne.g.\r\n\r\n> if `restored-logs-2023.07.11-000024` is `RED` but `logs-2023.07.11-000024` is `GREEN` the health API returns GREEN\r\nif `restored-logs-2023.07.11-000024` is `RED` AND `logs-2023.07.11-000024` is missing or `RED` itself, then the health API starts reporting on the health of the `restored-logs-2023.07.11-000024` (which would be `RED` already due to the source/original index being `RED` in the case when it still exists)\r\n\r\n\r\nFixes: https://github.com/elastic/elasticsearch/issues/97606",
        "comments": 9
    },
    {
        "merged": true,
        "additions": 11,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-12T14:57:51Z",
        "closed_at": "2023-10-12T15:41:54Z",
        "merged_at": "2023-10-12T15:41:54Z",
        "body": "Backports the following commits to 8.11:\n - [ML] Remove noisy 'Could not find trained model' message (#100760)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 9,
        "changed_files": 1,
        "created_at": "2023-10-12T14:31:48Z",
        "closed_at": "2023-10-12T15:13:51Z",
        "merged_at": "2023-10-12T15:13:51Z",
        "body": "Backports the following commits to 8.11:\n - Don't test broken index templates (#100745)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 23,
        "deletions": 0,
        "changed_files": 2,
        "created_at": "2023-10-12T14:30:31Z",
        "closed_at": "2023-10-13T11:28:24Z",
        "merged_at": "2023-10-13T11:28:24Z",
        "body": "Release notes for the 8.10.4 release",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 16,
        "deletions": 9,
        "changed_files": 1,
        "created_at": "2023-10-12T13:45:33Z",
        "closed_at": "2023-10-13T13:07:20Z",
        "merged_at": "2023-10-13T13:07:20Z",
        "body": "This change enables additional logging for\r\ntestClusterSettingsUpdateNotAcknowledged and makes sure the wait time is bound.\r\n\r\nRelated to: #98918 ",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 44,
        "deletions": 34,
        "changed_files": 4,
        "created_at": "2023-10-12T13:27:16Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Moving `NodeInfo` from Version to opaque String-based version.\r\n\r\nMany tests rely on having the `GET _nodes` answer containing a `Version` parseable \"version\" field; changes in https://github.com/elastic/elasticsearch/pull/100673 do not affect them since we still use Version (toString) in NodeInfo.\r\nHowever, https://github.com/elastic/elasticsearch/pull/100746 introduces a change to the type passed to the NodeInfo ctor; now we can pass any \"version\" string, and if we use a non-semantic, opaque version there, integration tests that read it through the API break.\r\n\r\nI am working through the tests and updating them to make them \"compatible\"; this first PR addresses a first set of IT tests.",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 1980,
        "deletions": 1484,
        "changed_files": 6,
        "created_at": "2023-10-12T13:07:47Z",
        "closed_at": null,
        "merged_at": null,
        "body": "The first part of a series of PRs to get the `Node` constructor under control.\r\n\r\nThis creates a `NodeConstructor` class and moves the service creation into that class, splitting up each section into its own method. Mock instances are injected using a `NodeServiceProvider` implementation by `MockNode`.\r\n\r\nThere is an unavoidably large amount of churn here, due to the very large size of the constructor method. I have kept the operation ordering the same, as much as is sensible, so `NodeConstructor` is best reviewed side-by-side with the existing `Node` implementation. I have not changed any of the operations that are actually performed, just moved them around.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 41,
        "deletions": 43,
        "changed_files": 1,
        "created_at": "2023-10-12T12:49:33Z",
        "closed_at": "2023-10-13T04:45:16Z",
        "merged_at": "2023-10-13T04:45:16Z",
        "body": "No need for a `GroupedActionListener` to build a list of all the shard\r\nresults per index, which are then copied them to another list, stored in\r\nanother per-index `GroupedActionListener`, copied again, and finally\r\nconcatenated into the final list. This commit computes the resulting\r\nlist directly.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 80,
        "deletions": 13,
        "changed_files": 7,
        "created_at": "2023-10-12T12:39:24Z",
        "closed_at": "2023-10-13T08:21:13Z",
        "merged_at": "2023-10-13T08:21:13Z",
        "body": "Fixes https://github.com/elastic/elasticsearch/issues/100497\r\n\r\nMV are treated as single values when the collection has actually only one value; when the collection has multiple values, the functions will return null.",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 145,
        "deletions": 15,
        "changed_files": 7,
        "created_at": "2023-10-12T12:33:39Z",
        "closed_at": "2023-10-12T13:34:20Z",
        "merged_at": "2023-10-12T13:34:20Z",
        "body": "Backports the following commits to 8.11:\n - [ML] Wait to gracefully stop deployments until alternative allocation exists (#99107)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-12T12:29:00Z",
        "closed_at": "2023-10-16T07:30:51Z",
        "merged_at": "2023-10-16T07:30:51Z",
        "body": "Follow up after https://github.com/elastic/elasticsearch/pull/100684\r\n\r\nThe issue with the FTR tests hasn't resolved, because I left out `delete_index` privilege. I decided to use `all` to make sure nothing else is missing.\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)? yes\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)? yes\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`? yes\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed. yes\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)? yes\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 70,
        "deletions": 27,
        "changed_files": 3,
        "created_at": "2023-10-12T12:28:54Z",
        "closed_at": "2023-10-12T13:53:12Z",
        "merged_at": "2023-10-12T13:53:12Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.11`:\n - [[ML] Fixing put inference service request hanging (#100725)](https://github.com/elastic/elasticsearch/pull/100725)\n\n<!--- Backport version: 9.2.3 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 11,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-12T11:14:53Z",
        "closed_at": "2023-10-12T14:54:14Z",
        "merged_at": "2023-10-12T14:54:13Z",
        "body": "[ModelLoadingService](https://github.com/elastic/elasticsearch/blob/main/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/inference/loadingservice/ModelLoadingService.java) watches for the creation of ingest pipelines that use the ingest processor and pre-loads the model referenced in the new pipeline. If the model does not exist because the pipeline has been created before the model an error message is logged, this can happen quite a lot producing spurious error messages. Often this will be because a solution creates ingest pipeline referencing the ELSER model before ELSER has been downloaded.\r\n\r\n`ModelLoadingService` only handles DFA/Boosted tree models which are loaded on ingest nodes, it does not load PyTorch/NLP models but it first has to read the model config to know what type the model is.\r\n\r\nIf is very easy to cause the error message to be logged, just create a ingest processor with an unknown model id\r\n```\r\nPUT _ingest/pipeline/elser\r\n{\r\n  \"processors\": [\r\n    {\r\n      \"inference\": {\r\n        \"model_id\": \"not-a-model\",\r\n        \"field_map\": {\r\n          \"body\": \"text_field\"\r\n        },\r\n        \"target_field\": \"ml\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nAnd the following is logged.\r\n\r\n```\r\n[2023-10-12T09:45:51,528][WARN ][o.e.x.m.i.l.ModelLoadingService] [host] [not-a-model] failed to load model configurationorg.elasticsearch.ResourceNotFoundException: Could not find trained model [not-a-model]\r\n\tat org.elasticsearch.ml@8.11.0/org.elasticsearch.xpack.ml.inference.persistence.TrainedModelProvider.lambda$getTrainedModel$22(TrainedModelProvider.java:670)\r\n\tat org.elasticsearch.server@8.11.0/org.elasticsearch.action.ActionListener$2.onResponse(ActionListener.java:177)\r\n\tat org.elasticsearch.server@8.11.0/org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:32)\r\n\tat org.elasticsearch.server@8.11.0/org.elasticsearch.client.internal.node.NodeClient$SafelyWrappedActionListener.onResponse(NodeClient.java:161)\r\n\tat org.elasticsearch.server@8.11.0/org.elasticsearch.tasks.TaskManager$1.onResponse(TaskManager.java:203)\r\n```",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 51,
        "deletions": 46,
        "changed_files": 1,
        "created_at": "2023-10-12T10:37:00Z",
        "closed_at": "2023-10-12T12:30:18Z",
        "merged_at": "2023-10-12T12:30:17Z",
        "body": "No need for a `GroupedActionListener` to build a list of all the shard\r\ncounts, which is then copied to a new list to filter out nulls, if we're\r\njust trying to compute the maximum. This commit computes the maximum\r\ndirectly.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-12T09:43:17Z",
        "closed_at": "2023-10-12T10:00:28Z",
        "merged_at": "2023-10-12T10:00:28Z",
        "body": "Backports the following commits to 8.10:\n - More S3-compatible repo deflection (#100754)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-12T09:43:01Z",
        "closed_at": "2023-10-12T10:00:31Z",
        "merged_at": "2023-10-12T10:00:31Z",
        "body": "Backports the following commits to 8.11:\n - More S3-compatible repo deflection (#100754)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 6,
        "changed_files": 1,
        "created_at": "2023-10-12T09:33:49Z",
        "closed_at": "2023-10-13T06:18:00Z",
        "merged_at": "2023-10-13T06:18:00Z",
        "body": "Terms aggregation supports a `global_ordinals` execution hint that switches the underlying implementation to use\r\n`GlobalOrdinalsStringTermsAggregator`. If applied on a text field, fielddata get populated. However, in mixedClusterTests there are many nodes, and some contain no data so fielddata won't get populated either.\r\n\r\nFixes #99774\r\n\r\n",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-12T09:24:57Z",
        "closed_at": "2023-10-12T09:41:51Z",
        "merged_at": "2023-10-12T09:41:51Z",
        "body": "Call out explicitly that users need to reproduce issues with the real S3\r\nbefore reporting them to ES.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 26,
        "deletions": 15,
        "changed_files": 1,
        "created_at": "2023-10-12T08:55:49Z",
        "closed_at": "2023-10-12T20:21:45Z",
        "merged_at": "2023-10-12T20:21:44Z",
        "body": "This is a forward port of #94655.\r\n\r\nML artifacts are stored on both S3 and GCS. On GCS they're fronted by a CDN but on S3 they are not. About a year ago there were problems with the GCS CDN that led to many incomplete downloads. As a result the ML downloads were switched to use S3 in #92381. Those problems were supposed to be fixed about 6 months ago, and the 8.7 branch was switched back to GCS in #94655. However, the main branch was left using S3.\r\n\r\nNow that we believe GCS is stable the benefits of having its CDN and hence fast downloads worldwide means it is best to switch back to it as the primary download location.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-12T08:43:51Z",
        "closed_at": "2023-10-12T09:30:10Z",
        "merged_at": "2023-10-12T09:30:10Z",
        "body": "We can't refer to `executeConsistentStateUpdate` here because it's\r\nprivate. Doesn't really matter, except that IntelliJ reports it as an\r\nerror.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 21,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-12T08:12:35Z",
        "closed_at": "2023-10-13T13:37:49Z",
        "merged_at": "2023-10-13T13:37:48Z",
        "body": "This makes the implicit ILM rollover conditions a bit more visible \r\nacross the ILM docs.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 24,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-12T07:51:03Z",
        "closed_at": "2023-10-12T08:08:08Z",
        "merged_at": "2023-10-12T08:08:08Z",
        "body": "Backports the following commits to 8.10:\n - [Docs] Link to AWS SDK documentation for requests logging (#100491)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 24,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-12T07:50:47Z",
        "closed_at": "2023-10-12T08:07:56Z",
        "merged_at": "2023-10-12T08:07:56Z",
        "body": "Backports the following commits to 8.11:\n - [Docs] Link to AWS SDK documentation for requests logging (#100491)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-12T07:39:15Z",
        "closed_at": "2023-10-12T07:55:36Z",
        "merged_at": "2023-10-12T07:55:36Z",
        "body": null,
        "comments": 2
    },
    {
        "merged": false,
        "additions": 49,
        "deletions": 35,
        "changed_files": 14,
        "created_at": "2023-10-12T06:58:40Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Follows https://github.com/elastic/elasticsearch/pull/100673 and will be updated with that before merging",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 9,
        "changed_files": 1,
        "created_at": "2023-10-12T06:35:56Z",
        "closed_at": "2023-10-12T14:29:06Z",
        "merged_at": "2023-10-12T14:29:06Z",
        "body": "So far we've tested in the index template registry tests for Universal Profiling what happens on outdated resources. However, the test not only tested for outdated resources but also for completely broken ones, i.e. that the `version` property is missing. That cannot happen in practice because the plugin itself controls installation of index templates where the `version` property is always present. Hence, we don't test for this case anymore.\r\n\r\nCloses #99943",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 157,
        "deletions": 133,
        "changed_files": 1,
        "created_at": "2023-10-12T06:33:06Z",
        "closed_at": "2023-10-12T10:07:02Z",
        "merged_at": "2023-10-12T10:07:02Z",
        "body": "Encapsulates the per-index and per-shard logic for deleting snapshots in\r\ntheir own objects.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 4,
        "created_at": "2023-10-12T06:29:46Z",
        "closed_at": "2023-10-12T07:25:22Z",
        "merged_at": "2023-10-12T07:25:22Z",
        "body": "Backports the following commits to 8.11:\n - Update doc links for the inference API (#100690)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 101,
        "deletions": 73,
        "changed_files": 2,
        "created_at": "2023-10-12T05:05:33Z",
        "closed_at": "2023-10-12T21:32:32Z",
        "merged_at": "2023-10-12T21:32:32Z",
        "body": "Backports the following commits to 8.11:\n - Re-enable EsqlActionBreakerIT (#100698)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 19,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-12T04:10:04Z",
        "closed_at": "2023-10-12T19:01:59Z",
        "merged_at": null,
        "body": "Currently the engine can throw already closed exceptions when underlying\r\nresources are closed. Occasionally it is necessary to throw this\r\nexception due to shard movements. This commit adds this exception for\r\nthese circumstances.",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 497,
        "deletions": 466,
        "changed_files": 5,
        "created_at": "2023-10-12T00:49:03Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Extend the unquoted identifier to contain . not just numbers. Without it\r\n the lexer picks the characters as decimal literal which leads to errors\r\n\r\nFix #100312",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 28,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-11T23:49:59Z",
        "closed_at": "2023-10-12T00:36:12Z",
        "merged_at": "2023-10-12T00:36:12Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Improve verifier error for incorrect agg declaration (#100650)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 56,
        "deletions": 66,
        "changed_files": 10,
        "created_at": "2023-10-11T22:15:52Z",
        "closed_at": "2023-10-12T16:59:22Z",
        "merged_at": "2023-10-12T16:59:22Z",
        "body": "Similar to TransportVersion constants, this commit updates IndexVersion constants to use descriptive names. With descriptive names uuids are no longer needed, so those are also removed.",
        "comments": 6
    },
    {
        "merged": false,
        "additions": 21,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-11T21:47:24Z",
        "closed_at": null,
        "merged_at": null,
        "body": "See title.",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 102,
        "deletions": 13,
        "changed_files": 4,
        "created_at": "2023-10-11T21:26:31Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This PR should be updated a bit once https://github.com/elastic/elasticsearch/pull/100713/ is merged.\r\n\r\nWe want plugin descriptors to be able to return opaque strings from `getElasticsearchVersion`. The one problem here is that the stable plugin API assumes semantic versioning for determining compatibility: a plugin from an earlier release of the same major version can be loaded, but not one from a future release. So we check to see if the current build version can be parsed as a semantic version, and, if so, we apply this logic.\r\n\r\nThe exception is if the plugin's build version exactly matches the current build version, so that a stable plugin can be used with the same non-semantic version of Elasticsearch that it's built with (just like the old style of plugin).",
        "comments": 5
    },
    {
        "merged": false,
        "additions": 14,
        "deletions": 2,
        "changed_files": 2,
        "created_at": "2023-10-11T21:05:37Z",
        "closed_at": null,
        "merged_at": null,
        "body": "See title.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-11T20:46:21Z",
        "closed_at": "2023-10-11T21:27:28Z",
        "merged_at": "2023-10-11T21:27:28Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Release drivers and their containing operators in case of failure during setup (#100730)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 44,
        "deletions": 44,
        "changed_files": 2,
        "created_at": "2023-10-11T20:24:32Z",
        "closed_at": "2023-10-13T12:12:17Z",
        "merged_at": "2023-10-13T12:12:17Z",
        "body": "We received feedback that different examples of `match_criteria` in various parts of the query rules documentation was confusing. This PR streamlines the examples in our query rules documentation (APIs, rule query and search guide). ",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 882,
        "deletions": 38,
        "changed_files": 9,
        "created_at": "2023-10-11T20:04:16Z",
        "closed_at": "2023-10-13T17:07:05Z",
        "merged_at": "2023-10-13T17:07:04Z",
        "body": "Re-opening this change against a feature branch.\r\n\r\nhttps://github.com/elastic/elasticsearch/pull/100561",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-11T19:58:37Z",
        "closed_at": "2023-10-11T20:45:15Z",
        "merged_at": "2023-10-11T20:45:15Z",
        "body": "Another small change to release previously created Drivers (and their containing operators), in the case of failure during pipeline creation.\r\n\r\nThis was spotted during the hunt to track down leaks resulting from trying to stabalize EsqlActionBreakerIT.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-11T19:54:39Z",
        "closed_at": "2023-10-11T20:11:21Z",
        "merged_at": "2023-10-11T20:11:21Z",
        "body": "muting test for gh: https://github.com/elastic/elasticsearch/issues/100596",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 1957,
        "deletions": 546,
        "changed_files": 78,
        "created_at": "2023-10-11T19:34:37Z",
        "closed_at": null,
        "merged_at": null,
        "body": "TestAPMMeter has a RecordingMeterProvider and otel.Meter that records all calls.",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-11T19:24:35Z",
        "closed_at": "2023-10-11T20:07:56Z",
        "merged_at": "2023-10-11T20:07:56Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: allow EsqlActionBreakerIT test to trip the breaker during deseialization off the wire (#100699)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 13,
        "deletions": 16,
        "changed_files": 1,
        "created_at": "2023-10-11T19:21:36Z",
        "closed_at": "2023-10-11T20:06:31Z",
        "merged_at": "2023-10-11T20:06:31Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: OrdinalSegmentAggregator rework release in case of failure (#100696)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 70,
        "deletions": 27,
        "changed_files": 3,
        "created_at": "2023-10-11T19:18:35Z",
        "closed_at": "2023-10-12T12:25:05Z",
        "merged_at": "2023-10-12T12:25:04Z",
        "body": "This PR fixes an issue with the inference plugin where `listener.onResponse` wasn't being called for the elser service. The bug can be encountered when interacting with the elser service locally.\r\n\r\n## Testing\r\n\r\n- Download elser v2\r\n- Do the following put request and it should succeed\r\n\r\n```\r\ncurl --location --request PUT 'http://localhost:9200/_inference/sparse_embedding/test' \\\r\n--header 'Content-Type: application/json' \\\r\n--header 'Authorization: Basic ZWxhc3RpYzpwYXNzd29yZA==' \\\r\n--data '{\r\n    \"service\": \"elser_mlnode\",\r\n    \"service_settings\": {\r\n        \"num_allocations\": 1,\r\n        \"num_threads\": 1\r\n    },\r\n    \"task_settings\": {\r\n    }\r\n}'\r\n```",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 228,
        "deletions": 19,
        "changed_files": 12,
        "created_at": "2023-10-11T19:10:52Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Today, we have a hierarchy of tasks in ESQL designed to leverage the task framework for reporting status and cancellation.\r\n\r\n```mermaid\r\nflowchart\r\n RESTLayer -->|  EsqlQueryRequest indices:data/read/esql  | ComputeService\r\n ComputeService -->| DriverRequest indices:data/read/esql/compute | Driver\r\n ComputeService -->| DataNodeRequest indices:data/read/esql/data | DataNode\r\n DataNode -->| DriverRequest indices:data/read/esql/compute | Driver\r\n Driver -->| LookupRequest indices:data/read/esql/lookup | EnrichLookupService\r\n```\r\n\r\nThe primary issue here is that `DriverRequest` is neither `IndicesRequest` nor `CompositeIndicesRequest`. Consequently, the Driver is executed within the context of the system user, leading to access indices with the system user.\r\n\r\nTo address this issue, this PR makes `DriverRequest` a `CompositeIndicesRequest` and ensures that the Driver executes within the user's context. With this fix we can now properly capture the response headers when a Driver is yielded and rescheduled (see https://github.com/elastic/elasticsearch/issues/100164#issuecomment-1753772700).\r\n\r\nRelates #100707\r\nRelates #99646\r\n\r\nRelates #99926\r\nCloses #100164",
        "comments": 12
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T19:08:42Z",
        "closed_at": "2023-10-11T19:09:10Z",
        "merged_at": "2023-10-11T19:09:10Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `7.17`:\n - [[buildkite] Pin version of bun being used due to bug in latest (1.0.5) (#100720)](https://github.com/elastic/elasticsearch/pull/100720)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T19:08:25Z",
        "closed_at": "2023-10-11T19:09:06Z",
        "merged_at": "2023-10-11T19:09:06Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.10`:\n - [[buildkite] Pin version of bun being used due to bug in latest (1.0.5) (#100720)](https://github.com/elastic/elasticsearch/pull/100720)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T19:08:13Z",
        "closed_at": "2023-10-11T19:09:03Z",
        "merged_at": "2023-10-11T19:09:03Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.11`:\n - [[buildkite] Pin version of bun being used due to bug in latest (1.0.5) (#100720)](https://github.com/elastic/elasticsearch/pull/100720)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T19:06:10Z",
        "closed_at": "2023-10-11T19:07:45Z",
        "merged_at": "2023-10-11T19:07:45Z",
        "body": "bun is hanging on execution. Possibly this: https://github.com/oven-sh/bun/issues/6414",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 19,
        "deletions": 7,
        "changed_files": 2,
        "created_at": "2023-10-11T18:42:36Z",
        "closed_at": null,
        "merged_at": null,
        "body": "See title",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 1,
        "deletions": 5,
        "changed_files": 1,
        "created_at": "2023-10-11T18:39:27Z",
        "closed_at": null,
        "merged_at": null,
        "body": "During cleanup these `RepositoryData` objects refer to the same\r\nsnapshots so it doesn't really matter, but for the sake of consistency\r\nwe should use the updated `RepositoryData` here.\r\n\r\nRelates a comment on #100657",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 40,
        "deletions": 37,
        "changed_files": 1,
        "created_at": "2023-10-11T18:36:21Z",
        "closed_at": "2023-10-11T19:18:03Z",
        "merged_at": "2023-10-11T19:18:03Z",
        "body": "Backports the following commits to 8.11:\n - Ensure release vector builder in QuantileStates (#100693)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 29,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-11T18:29:51Z",
        "closed_at": "2023-10-11T19:50:59Z",
        "merged_at": "2023-10-11T19:50:59Z",
        "body": "Backports the following commits to 8.11:\n - Allow enrich_user to read/view enrich indices (#100707)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 213,
        "deletions": 192,
        "changed_files": 16,
        "created_at": "2023-10-11T18:26:01Z",
        "closed_at": "2023-10-16T10:18:08Z",
        "merged_at": "2023-10-16T10:18:08Z",
        "body": "# Backport\r\n\r\nThis will backport the following commits from `main` to `7.17`:\r\n - [Update gradle wrapper to 8.3 (#97838)](https://github.com/elastic/elasticsearch/pull/97838)\r\n - [Use patched nebula os package gradle plugin (#100280)](https://github.com/elastic/elasticsearch/pull/100280)\r\n \r\n<!--- Backport version: 8.9.8 -->\r\n\r\n### Questions ?\r\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 173,
        "deletions": 175,
        "changed_files": 11,
        "created_at": "2023-10-11T18:17:34Z",
        "closed_at": "2023-10-12T06:23:08Z",
        "merged_at": "2023-10-12T06:23:08Z",
        "body": "Today we rely on the caller computing the appropriate repository format\r\nversion based on the nodes in the cluster and the snapshots in (some\r\nrecent copy of) the `RepositoryData`. This commit moves that computation\r\ninto `createSnapshotsDeletion` so that (a) we can be sure to use the\r\nsame `RepositoryData` used for the rest of the process, and (b) we avoid\r\ndispatching work to the SNAPSHOT pool twice.\r\n\r\nRelates a comment on #100657",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 55,
        "deletions": 40,
        "changed_files": 7,
        "created_at": "2023-10-11T18:15:56Z",
        "closed_at": "2023-10-17T21:20:06Z",
        "merged_at": "2023-10-17T21:20:06Z",
        "body": "Since the work to use a String version in the plugin descriptor is pretty simple, I'm putting it in its own PR and saving the work changing `PluginDescriptor#getElasticsearchVersion` to return a string for a follow-up PR.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 182,
        "deletions": 149,
        "changed_files": 4,
        "created_at": "2023-10-11T18:12:25Z",
        "closed_at": "2023-10-11T18:15:18Z",
        "merged_at": "2023-10-11T18:15:18Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `7.17`:\n - [[buildkite] Add more logging and debug information to PR pipeline generation (#100709)](https://github.com/elastic/elasticsearch/pull/100709)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 182,
        "deletions": 149,
        "changed_files": 4,
        "created_at": "2023-10-11T18:12:06Z",
        "closed_at": "2023-10-11T18:15:16Z",
        "merged_at": "2023-10-11T18:15:16Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.10`:\n - [[buildkite] Add more logging and debug information to PR pipeline generation (#100709)](https://github.com/elastic/elasticsearch/pull/100709)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 182,
        "deletions": 149,
        "changed_files": 4,
        "created_at": "2023-10-11T18:11:54Z",
        "closed_at": "2023-10-11T18:15:12Z",
        "merged_at": "2023-10-11T18:15:12Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.11`:\n - [[buildkite] Add more logging and debug information to PR pipeline generation (#100709)](https://github.com/elastic/elasticsearch/pull/100709)\n\n<!--- Backport version: 9.2.1 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 182,
        "deletions": 149,
        "changed_files": 4,
        "created_at": "2023-10-11T17:58:01Z",
        "closed_at": "2023-10-11T18:11:28Z",
        "merged_at": "2023-10-11T18:11:28Z",
        "body": "So that when things go wrong, it will be easier to tell what happened.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 29,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-11T17:11:25Z",
        "closed_at": "2023-10-11T18:28:35Z",
        "merged_at": "2023-10-11T18:28:35Z",
        "body": "> Error: [esql] > Unexpected error from Elasticsearch: security_exception - action [indices:data/read/esql/lookup] is unauthorized for user [guest] with effective roles [enrich_user,esql-read-role] on restricted indices [.enrich-group_lookup-1696927917972], this action is granted by the index privileges [read,all]\r\n\r\nCurrently, the enrich indices (.enrich-*) are restricted system indices managed by the enrich plugin. While the `enrich_user` should not be allowed to manage or write to these indices, they should be allowed to read and view_index_metadata. This is necessary for ESQL; otherwise, ESQL users would require broader privileges to perform enrich in ESQL.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 116,
        "deletions": 6,
        "changed_files": 22,
        "created_at": "2023-10-11T16:39:44Z",
        "closed_at": "2023-10-11T17:23:00Z",
        "merged_at": "2023-10-11T17:23:00Z",
        "body": "Backports the following commits to 8.11:\n - Allow release vector without release its block (#100688)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 9,
        "deletions": 4,
        "changed_files": 1,
        "created_at": "2023-10-11T16:33:28Z",
        "closed_at": "2023-10-11T19:31:04Z",
        "merged_at": "2023-10-11T19:31:04Z",
        "body": "Relates to PR #98204",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 889,
        "deletions": 30,
        "changed_files": 13,
        "created_at": "2023-10-11T16:31:36Z",
        "closed_at": "2023-10-13T07:05:23Z",
        "merged_at": "2023-10-13T07:05:23Z",
        "body": "Renamed top-level directory to **Search Analytics** per Serena's good idea\r\n\r\n<img width=\"300\" alt=\"Screenshot 2023-10-12 at 14 12 33\" src=\"https://github.com/elastic/elasticsearch/assets/32779855/5093338b-2a87-4020-942a-311044f835b0\">\r\n",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 58,
        "deletions": 20,
        "changed_files": 7,
        "created_at": "2023-10-11T16:20:14Z",
        "closed_at": "2023-10-14T11:04:37Z",
        "merged_at": "2023-10-14T11:04:36Z",
        "body": "New test that updates the content of a ByteReference by calling ByteReference#iterator.",
        "comments": 6
    },
    {
        "merged": true,
        "additions": 6,
        "deletions": 5,
        "changed_files": 2,
        "created_at": "2023-10-11T16:16:38Z",
        "closed_at": "2023-10-11T16:56:47Z",
        "merged_at": "2023-10-11T16:56:47Z",
        "body": "Backports the following commits to 7.17:\n - Exclude BWC tests in platform support testing matrix (#100643)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 5,
        "changed_files": 2,
        "created_at": "2023-10-11T15:53:48Z",
        "closed_at": "2023-10-11T16:33:28Z",
        "merged_at": "2023-10-11T16:33:28Z",
        "body": "Backports the following commits to 8.10:\n - Exclude BWC tests in platform support testing matrix (#100643)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 5,
        "changed_files": 2,
        "created_at": "2023-10-11T15:53:13Z",
        "closed_at": "2023-10-11T16:33:53Z",
        "merged_at": "2023-10-11T16:33:53Z",
        "body": "Backports the following commits to 8.11:\n - Exclude BWC tests in platform support testing matrix (#100643)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 12,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-11T15:44:52Z",
        "closed_at": "2023-10-11T19:23:30Z",
        "merged_at": "2023-10-11T19:23:30Z",
        "body": "This commit allows EsqlActionBreakerIT test to trip the breaker during deseialization off the wire, which is needed to support failure exception assertions in the test.  Thanks @dnhatn ",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 101,
        "deletions": 73,
        "changed_files": 2,
        "created_at": "2023-10-11T15:44:37Z",
        "closed_at": "2023-10-12T05:04:31Z",
        "merged_at": "2023-10-12T05:04:31Z",
        "body": "Closes #100681",
        "comments": 7
    },
    {
        "merged": true,
        "additions": 130,
        "deletions": 122,
        "changed_files": 6,
        "created_at": "2023-10-11T15:40:55Z",
        "closed_at": "2023-10-12T05:41:10Z",
        "merged_at": "2023-10-12T05:41:10Z",
        "body": "# Backport\n\nThis will backport the following commits from `main` to `8.11`:\n - [[DOCS] Updates ELSER tutorial with inference processor changes (#100420)](https://github.com/elastic/elasticsearch/pull/100420)\n\n<!--- Backport version: 9.3.0 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 13,
        "deletions": 16,
        "changed_files": 1,
        "created_at": "2023-10-11T15:38:51Z",
        "closed_at": "2023-10-11T19:20:27Z",
        "merged_at": "2023-10-11T19:20:27Z",
        "body": "This commit reworks resource release inside OrdinalSegmentAggregator, in case of failure.  Previously it was possible to release the aggregators a second time, if the bitArray creation failed.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-11T15:20:39Z",
        "closed_at": "2023-10-13T08:39:48Z",
        "merged_at": "2023-10-13T08:39:48Z",
        "body": "Due to the recent introduction of concurrency, this test can fail because the different way of calculating the values. Adjust the error from 0.1 to 0.2. There is no scientific reason I choose that value but no other than other test setting that value.\r\n\r\nfixes https://github.com/elastic/elasticsearch/issues/100689",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-11T15:05:27Z",
        "closed_at": "2023-10-11T16:11:17Z",
        "merged_at": "2023-10-11T16:11:17Z",
        "body": "If an SLM policy happens to run during a rest test, an slm history index will be created, which then causes a failure during test cleanup like:\r\n```\r\norg.elasticsearch.smoketest.DocsClientYamlTestSuiteIT > test {yaml=reference/query-dsl/simple-query-string-query/line_291} FAILED\r\n    org.elasticsearch.client.ResponseException: method [DELETE], host [http://127.0.0.1:43027], URI [*,-.ds-ilm-history-*?expand_wildcards=open%2Cclosed%2Chidden], status line [HTTP/1.1 400 Bad Request]\r\n    {\"error\":{\"root_cause\":[{\"type\":\"illegal_argument_exception\",\"reason\":\"index [.ds-.slm-history-5-2023.10.09-000001] is the write index for data stream [.slm-history-5] and cannot be deleted\"}],\"type\":\"illegal_argument_exception\",\"reason\":\"index [.ds-.slm-history-5-2023.10.09-000001] is the write index for data stream [.slm-history-5] and cannot be deleted\"},\"status\":400}\r\n        at __randomizedtesting.SeedInfo.seed([E12124F261F0BF90:69751B28CF0CD268]:0)\r\n        at app//org.elasticsearch.client.RestClient.convertResponse(RestClient.java:347)\r\n        at app//org.elasticsearch.client.RestClient.performRequest(RestClient.java:313)\r\n        at app//org.elasticsearch.client.RestClient.performRequest(RestClient.java:288)\r\n        at app//org.elasticsearch.test.rest.ESRestTestCase.wipeAllIndices(ESRestTestCase.java:981)\r\n        at app//org.elasticsearch.test.rest.ESRestTestCase.wipeCluster(ESRestTestCase.java:729)\r\n        at app//org.elasticsearch.test.rest.ESRestTestCase.cleanUpCluster(ESRestTestCase.java:421)\r\n        at java.base@21/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)\r\n        at java.base@21/java.lang.reflect.Method.invoke(Method.java:580)\r\n        at app//com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1758)\r\n```\r\nThis PR excludes the SLM history index from deletion the same way we exclude the ILM history index.\r\n\r\nCloses #100536",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 40,
        "deletions": 37,
        "changed_files": 1,
        "created_at": "2023-10-11T15:03:52Z",
        "closed_at": "2023-10-11T18:35:09Z",
        "merged_at": "2023-10-11T18:35:09Z",
        "body": "Ensure that we always release the vector builders in case we hit the breaker in QuantileStates.",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 11,
        "deletions": 11,
        "changed_files": 1,
        "created_at": "2023-10-11T14:53:45Z",
        "closed_at": "2023-10-11T15:50:58Z",
        "merged_at": "2023-10-11T15:50:58Z",
        "body": "similar to: https://github.com/elastic/elasticsearch/pull/100557",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 4,
        "created_at": "2023-10-11T14:50:59Z",
        "closed_at": "2023-10-12T06:26:44Z",
        "merged_at": "2023-10-12T06:26:44Z",
        "body": null,
        "comments": 3
    },
    {
        "merged": true,
        "additions": 116,
        "deletions": 6,
        "changed_files": 22,
        "created_at": "2023-10-11T14:45:13Z",
        "closed_at": "2023-10-11T16:38:39Z",
        "merged_at": "2023-10-11T16:38:39Z",
        "body": "Today, a vector must be closed via its block. This PR removes this restriction as there are cases where we [only](https://github.com/elastic/elasticsearch/blob/5cc90094e9b24203e92649b1470736e984f59e10/x-pack/plugin/esql/compute/src/main/java/org/elasticsearch/compute/operator/OrdinalsGroupingOperator.java#L282) interact with the vector.",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 413,
        "deletions": 93,
        "changed_files": 6,
        "created_at": "2023-10-11T14:31:52Z",
        "closed_at": "2023-10-11T15:20:16Z",
        "merged_at": "2023-10-11T15:20:16Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Paginate MV_EXPAND output (#100598)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-11T14:21:17Z",
        "closed_at": "2023-10-11T16:03:30Z",
        "merged_at": "2023-10-11T16:03:30Z",
        "body": "This adds an allowed warning when an index template is created in `Test Change Target Index with Default Pipeline`. This appears to happen more frequently now that we're running in the new test framework (https://github.com/elastic/elasticsearch/pull/100537). The index template creation was also just recently added in https://github.com/elastic/elasticsearch/pull/100540.\r\nCloses #100584",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T14:02:24Z",
        "closed_at": "2023-10-11T15:01:54Z",
        "merged_at": "2023-10-11T15:01:54Z",
        "body": "Backports the following commits to 8.11:\n - Don't use an asserting searcher at all in MatchingDirectoryReader (#100668)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T13:59:13Z",
        "closed_at": "2023-10-11T14:54:57Z",
        "merged_at": "2023-10-11T14:54:57Z",
        "body": "Follow up after https://github.com/elastic/elasticsearch/pull/100574\r\n\r\nAdded read and delete privilege to be able to read and delete the index in FTR tests.\r\nCurrently the lack of delete privilege is causing unrelated FTR tests to fail that are trying to delete indices: https://github.com/elastic/kibana/pull/168435\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)? yes\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)? yes\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`? yes\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed. yes\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)? yes\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 106,
        "deletions": 11,
        "changed_files": 3,
        "created_at": "2023-10-11T13:57:45Z",
        "closed_at": "2023-10-11T14:39:28Z",
        "merged_at": "2023-10-11T14:39:28Z",
        "body": "Backports the following commits to 8.11:\n - Harden discard logic in ExchangeBuffer (#100636)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 10,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-11T13:50:18Z",
        "closed_at": "2023-10-13T13:30:38Z",
        "merged_at": "2023-10-13T13:30:38Z",
        "body": "Excluding these tests as they cannot run reliably in a mixed cluster scenario.\r\nThese tests are already muted for specific version ranges (before - after 8.10), but they also need to be prevented from running mixed cluster tests altogether: if the cluster starts with 8.9 or before, the test is executed (the `- skip: version: \"8.9.99 - \"` will not apply). Then some nodes are upgraded to a post 8.10 version (current) and the behaviour may change.\r\n\r\nCloses https://github.com/elastic/elasticsearch/issues/100276\r\nCloses https://github.com/elastic/elasticsearch/issues/100676\r\n\r\nRelated https://github.com/elastic/elasticsearch/issues/100078",
        "comments": 6
    },
    {
        "merged": true,
        "additions": 837,
        "deletions": 108,
        "changed_files": 18,
        "created_at": "2023-10-11T12:37:04Z",
        "closed_at": "2023-10-16T18:15:03Z",
        "merged_at": "2023-10-16T18:15:03Z",
        "body": "This PR adds a queue to buffer http requests. This is necessary because the internal apache http client connection pool will block when attempting to lease a connection when none are available.\r\n\r\nIt also makes the `InferenceService` extend `Closeable` and calls close on each service when the node is stopping.\r\n\r\n## Testing\r\n\r\nThe inference API shouldn't spin up any threads at the moment unless the evictor's setting wait setting is changed. So in theory it shouldn't cause any issues with a node shutting down. I built a local deployment and stopped the node a couple times (via ctrl+c) and didn't see any issues with it hanging.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-11T12:36:18Z",
        "closed_at": "2023-10-13T08:14:51Z",
        "merged_at": "2023-10-13T08:14:51Z",
        "body": "First (simple) step for removing Version from NodeInfo.\r\nMove external users to use a String version; this should be safe as NodeInfo.getVersion was used just for serialization purposes.",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 992,
        "deletions": 16,
        "changed_files": 27,
        "created_at": "2023-10-11T12:34:47Z",
        "closed_at": null,
        "merged_at": null,
        "body": "WIP\r\n\r\nInference service implementation for hugging face.",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 23,
        "deletions": 38,
        "changed_files": 2,
        "created_at": "2023-10-11T11:43:01Z",
        "closed_at": "2023-10-11T14:22:56Z",
        "merged_at": "2023-10-11T14:22:56Z",
        "body": "Update release notes and release highlights for `8.11.0 BC2`",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 26,
        "deletions": 24,
        "changed_files": 7,
        "created_at": "2023-10-11T11:29:20Z",
        "closed_at": "2023-10-11T12:24:33Z",
        "merged_at": "2023-10-11T12:24:33Z",
        "body": "The only reason this method is throwing an exception is because the method ByteArrayOutputStream#close() is declaring it although it is a noop. Therefore it can be safely ignored.\r\n\r\nThanks @romseygeek for bringing into attention.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T11:19:28Z",
        "closed_at": "2023-10-11T13:58:57Z",
        "merged_at": "2023-10-11T13:58:57Z",
        "body": "Follow up to #100527\r\n\r\nWe are not testing anything to do with searching with this searcher, and so\r\nthere is no point in using `LuceneTestCase.newSearcher()` which will wrap\r\nit with all sorts of extra checks that may access the underlying reader in\r\nways that are not anticipated by tests.\r\n\r\nFixes #100460\r\nFixes #99024 ",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-11T10:35:20Z",
        "closed_at": "2023-10-11T12:16:39Z",
        "merged_at": "2023-10-11T12:16:39Z",
        "body": "Adjust the AutodetectMemoryLimitIT/testManyDistinctOverFields integration test to account for changed memory consumption due to upgrade of Boost.\r\n\r\nRelates https://github.com/elastic/ml-cpp/pull/2585\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 71,
        "deletions": 6,
        "changed_files": 2,
        "created_at": "2023-10-11T10:17:13Z",
        "closed_at": "2023-10-11T17:33:23Z",
        "merged_at": "2023-10-11T17:33:23Z",
        "body": "- Support java 21\n- fix configuration cache incompatiliby",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 9,
        "deletions": 0,
        "changed_files": 2,
        "created_at": "2023-10-11T10:08:03Z",
        "closed_at": "2023-10-11T12:20:36Z",
        "merged_at": null,
        "body": "TopHitsAggregator calls TopFieldCollector#populateScores from each slice, which in turn relies on createWeight calls against the searcher. This means that the createWeight call gets parallelized with Lucene 9.9, but it should not as we are already executing multiple slices concurrently. We have protecions in place in Lucene to avoid this problem, but we have to adapt our execution code in ContextIndexSearcher accordingly.\r\n\r\nThe goal is to utilize plain TaskExecutor from Lucene and avoid code duplication. In the meantime, we can disable concurrency for top hits aggregations as it causes actual issues currently in the lucene_snapshot branch.\r\n\r\nThis fix is not necessary on main because Lucene 9.8 does not parallelize createWeight, hence top hits is fine being parallelized on main. I plan on addressing this issue overall before we merge back lucene_snapshot into main.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 175,
        "deletions": 14,
        "changed_files": 9,
        "created_at": "2023-10-11T09:09:36Z",
        "closed_at": "2023-10-11T09:52:39Z",
        "merged_at": "2023-10-11T09:52:39Z",
        "body": "Backports the following commits to 8.11:\r\n\r\n* ESQL: fix non-null value being returned for unsupported data types in ValueSources (https://github.com/elastic/elasticsearch/pull/100656)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 946,
        "deletions": 756,
        "changed_files": 8,
        "created_at": "2023-10-11T09:02:05Z",
        "closed_at": "2023-10-11T09:41:23Z",
        "merged_at": "2023-10-11T09:41:23Z",
        "body": "Backports the following commits to 8.11:\n - Fix remaining logs tests (#100407)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 129,
        "deletions": 4,
        "changed_files": 4,
        "created_at": "2023-10-11T08:55:11Z",
        "closed_at": "2023-10-11T09:51:17Z",
        "merged_at": "2023-10-11T09:51:17Z",
        "body": "Backports the following commits to 8.11:\n - Fix interruption of markAllocationIdAsInSync (#100610)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 10,
        "deletions": 7,
        "changed_files": 1,
        "created_at": "2023-10-11T08:17:16Z",
        "closed_at": "2023-10-11T10:41:10Z",
        "merged_at": "2023-10-11T10:41:10Z",
        "body": "Backport #100518 to 8.11. This fixes #100587",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 368,
        "deletions": 72,
        "changed_files": 7,
        "created_at": "2023-10-11T07:21:31Z",
        "closed_at": "2023-10-11T09:02:02Z",
        "merged_at": "2023-10-11T09:02:02Z",
        "body": "Backports the following commits to 8.11:\n - DSL waits for the tsdb time boundaries to lapse (#100470)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 180,
        "deletions": 193,
        "changed_files": 2,
        "created_at": "2023-10-11T06:47:42Z",
        "closed_at": "2023-10-11T13:21:12Z",
        "merged_at": "2023-10-11T13:21:12Z",
        "body": "Repository cleanup is basically the same as deleting an empty set of\r\nsnapshots, and in particular it needs the same context as a snapshots\r\ndeletion. This commit moves the cleanup process and its dependent\r\nmethods within `SnapshotsDeletion` and removes a great deal of\r\nunnecessary argument-passing and other duplication.\r\n\r\nRelates #100568",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 175,
        "deletions": 14,
        "changed_files": 9,
        "created_at": "2023-10-11T06:26:18Z",
        "closed_at": "2023-10-11T08:48:04Z",
        "merged_at": "2023-10-11T08:48:04Z",
        "body": "Refine (and fix) all cases where an unsupported data type field's values are returned from ValueSources.\r\nImprove unsupported data types handling in TopN by catching non-null values encoding/decoding attempts for unsupported data types.\r\n\r\nFixes https://github.com/elastic/elasticsearch/issues/100048",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 75,
        "deletions": 9,
        "changed_files": 3,
        "created_at": "2023-10-11T06:23:48Z",
        "closed_at": "2023-10-12T12:15:34Z",
        "merged_at": "2023-10-12T12:15:34Z",
        "body": "Relates: https://github.com/elastic/elasticsearch/pull/99994#discussion_r1351706777\r\n\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 34,
        "deletions": 6,
        "changed_files": 2,
        "created_at": "2023-10-11T06:10:15Z",
        "closed_at": "2023-10-11T06:55:38Z",
        "merged_at": "2023-10-11T06:55:38Z",
        "body": "Backports the following commits to 8.11:\n - Relax ValueSources check in OrdinalsGroupingOperator (#100566)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 2,
        "changed_files": 3,
        "created_at": "2023-10-11T04:58:51Z",
        "closed_at": "2023-10-11T05:40:40Z",
        "merged_at": "2023-10-11T05:40:40Z",
        "body": "Backports the following commits to 8.11:\n - [Transform] Make Transform Feature Reset really wait for all the tasks (#100624)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 118,
        "deletions": 84,
        "changed_files": 3,
        "created_at": "2023-10-11T01:27:17Z",
        "closed_at": "2023-10-11T02:09:25Z",
        "merged_at": "2023-10-11T02:09:25Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Graceful handling of non-bool condition in the filter (#100645)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 28,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-11T00:56:35Z",
        "closed_at": "2023-10-11T23:46:27Z",
        "merged_at": "2023-10-11T23:46:27Z",
        "body": "Add specific check for aliased function declarations in stats\r\n\r\nFix #100641",
        "comments": 5
    },
    {
        "merged": false,
        "additions": 24,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-11T00:45:14Z",
        "closed_at": "2023-10-11T00:54:55Z",
        "merged_at": null,
        "body": "Improve the Verifier to handle queries with non-boolean expressions\r\n used in the WHERE clause (where 10)\r\nIn the process improve the readability of the Verifier class by\r\n extracting the checks into their own methods\r\n\r\nFix #100049 ",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 15,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-10T23:44:15Z",
        "closed_at": "2023-10-11T00:25:31Z",
        "merged_at": "2023-10-11T00:25:31Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Handle queries with non-existing enrich policies and no field (#100647)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 15,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-10T22:58:52Z",
        "closed_at": "2023-10-10T23:42:59Z",
        "merged_at": "2023-10-10T23:42:59Z",
        "body": "When dealing with non-existing policies, the validation code kept trying\r\n to determine the matching field resulting in a NPE.\r\n\r\nFix #100593",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 78,
        "deletions": 2,
        "changed_files": 6,
        "created_at": "2023-10-10T22:51:12Z",
        "closed_at": "2023-10-12T23:18:49Z",
        "merged_at": "2023-10-12T23:18:49Z",
        "body": "Currently this call trips over if Search/Count/Reindex API is queried with complex date-math index name which contains semicolon `:` inside\r\n```\r\ncurl -X GET \"localhost:9200/%3Cdatemath-%7B2001-01-01-13%7C%7C%2B1h%2Fh%7Byyyy-MM-dd-HH%7C-07%3A00%7D%7D%3E/_count?error_trace\"\r\n```\r\n\r\n(human readable index name is: `<datemath-{2001-01-01-13||+1h/h{yyyy-MM-dd-HH|-07:00}}>`\r\nand it evaluates to `datemath-2001-01-01-14`)\r\n\r\n{\"error\":{\"root_cause\":[{\"type\":\"no_such_remote_cluster_exception\",\"reason\":\"no such remote cluster: [<datemath-{2001-01-01-13||+1h/h{yyyy-MM-dd-HH|-07]\",\"stack_trace\":\"org.elasticsearch.transport.NoSuchRemoteClusterException: no such remote cluster: [<datemath-{2001-01-01-13||+1h/h{yyyy-MM-dd-HH|-07]\\n\\tat org.elasticsearch.server@8.12.0-SNAPSHOT/org.elasticsearch.cluster.metadata.ClusterNameExpressionResolver.resolveClusterNames(ClusterNameExpressionResolver.java:41)\\n\\tat org.elasticsearch.server@8.12.0-SNAPSHOT/org.elasticsearch.transport.RemoteClusterAware.groupClusterIndices(RemoteClusterAware.java:85)\\n\\tat org.elasticsearch.server@8.12.0-SNAPSHOT/org.elasticsearch.transport.RemoteClusterService.groupIndices(RemoteClusterService.java:181)\r\n\r\n\r\n\r\nMore info is here https://github.com/elastic/elasticsearch/pull/96968#discussion_r1352543265\r\n",
        "comments": 6
    },
    {
        "merged": true,
        "additions": 118,
        "deletions": 84,
        "changed_files": 3,
        "created_at": "2023-10-10T22:36:52Z",
        "closed_at": "2023-10-11T01:25:46Z",
        "merged_at": "2023-10-11T01:25:46Z",
        "body": "Improve the Verifier to handle queries with non-boolean expressions\r\n used in the WHERE clause (where 10)\r\nIn the process improve the readability of the Verifier class by\r\n extracting the checks into their own methods\r\n\r\nFix #100049\r\nFix #100409",
        "comments": 5
    },
    {
        "merged": false,
        "additions": 926,
        "deletions": 88,
        "changed_files": 51,
        "created_at": "2023-10-10T21:57:02Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Add callback option for gauges.  To test this, I added a sample use for gauges for threadpools.",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 5,
        "changed_files": 2,
        "created_at": "2023-10-10T21:34:45Z",
        "closed_at": "2023-10-11T15:51:26Z",
        "merged_at": "2023-10-11T15:51:26Z",
        "body": "We already run BWC tests as part of intake and in a separate periodic job. There's not much benefit in running them as well as part of our platform support matrix. This removes BWC testing from these jobs to reduce their execution time as well as stability.",
        "comments": 4
    },
    {
        "merged": false,
        "additions": 283,
        "deletions": 5,
        "changed_files": 5,
        "created_at": "2023-10-10T21:32:28Z",
        "closed_at": null,
        "merged_at": null,
        "body": "Replace duplicated aggregations in a stat with an alias (through a\r\n synthetic eval).\r\nAdditionally introduce agg normalization which replaces field aliases\r\n inside agg and the literals in Count with \"*\".\r\n\r\nThis improves the query:\r\n\r\neval x = salary\r\nstats c = count(), m = min(x), m1 = min(salary), c1 = count(1)\r\n\r\nto\r\nstats c = count(*), m = min(x)\r\neval m1 = m, c1 = c\r\nkeep c, m, m1, c1\r\n\r\nFix #100544",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 16,
        "deletions": 7,
        "changed_files": 2,
        "created_at": "2023-10-10T20:39:35Z",
        "closed_at": "2023-10-11T18:18:34Z",
        "merged_at": "2023-10-11T18:18:34Z",
        "body": "In some test environments, having 0 replicas results in searches not working. This PR changes the number of replicas to 1 to avoid failure in those environments.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 106,
        "deletions": 11,
        "changed_files": 3,
        "created_at": "2023-10-10T20:10:54Z",
        "closed_at": "2023-10-11T13:56:43Z",
        "merged_at": "2023-10-11T13:56:43Z",
        "body": "We can leave pages in the ExchangeBuffer if the `noMoreInputs` flag is set to true after we've checked it but before we add pages to the queue. I can reliably reproduce the `testFromLimit` by inserting a delay in between. This change hardens the discard logic by moving the check after we've added a Page to the queue. If the `noMoreInputs` flag is set to true, we will drain the pages from the queue.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 106,
        "deletions": 34,
        "changed_files": 2,
        "created_at": "2023-10-10T19:43:11Z",
        "closed_at": "2023-10-10T20:28:58Z",
        "merged_at": "2023-10-10T20:28:58Z",
        "body": "Backports the following commits to 8.11:\n - fix BlockAccountingTests and add a new filter test scenario (#100600)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-10T18:28:04Z",
        "closed_at": "2023-10-10T19:46:06Z",
        "merged_at": "2023-10-10T19:46:06Z",
        "body": "Backports the following commits to 8.10:\n - Capture JVM crash dump logs in uploaded artifact bundle (#100627)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-10T18:27:44Z",
        "closed_at": "2023-10-10T19:24:26Z",
        "merged_at": "2023-10-10T19:24:26Z",
        "body": "Backports the following commits to 7.17:\n - Capture JVM crash dump logs in uploaded artifact bundle (#100627)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-10T18:26:40Z",
        "closed_at": "2023-10-10T19:26:45Z",
        "merged_at": "2023-10-10T19:26:45Z",
        "body": "Backports the following commits to 8.11:\n - Capture JVM crash dump logs in uploaded artifact bundle (#100627)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 33,
        "deletions": 45,
        "changed_files": 6,
        "created_at": "2023-10-10T18:12:19Z",
        "closed_at": "2023-10-10T18:12:37Z",
        "merged_at": "2023-10-10T18:12:37Z",
        "body": "We have fix all of the major issues we discovered with the platform-support pipelines in Buildkite during testing, so let's fully migrate these.\r\n\r\nAlso, re-enable the other Buildkite periodic pipelines.",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-10T17:59:00Z",
        "closed_at": "2023-10-11T07:51:32Z",
        "merged_at": null,
        "body": "Relates ES-5356",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-10T17:34:36Z",
        "closed_at": "2023-10-10T18:28:03Z",
        "merged_at": "2023-10-10T18:28:03Z",
        "body": "Backports the following commits to 8.11:\n - Switch visibility to public in ESQL REST spec (#100622)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-10T17:28:10Z",
        "closed_at": "2023-10-10T18:24:54Z",
        "merged_at": "2023-10-10T18:24:54Z",
        "body": "We want to make sure we capture any JVM crash dump logs in our CI builds for later investigation.\r\n\r\nRelates to https://github.com/elastic/elasticsearch/issues/52610",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 63,
        "deletions": 3,
        "changed_files": 3,
        "created_at": "2023-10-10T17:06:27Z",
        "closed_at": "2023-10-11T14:08:31Z",
        "merged_at": "2023-10-11T14:08:31Z",
        "body": "#100588 introduced a patch transport version, this PR adds the same patch version and updates the serialisation logic\r\n\r\n- The field will be read if the transport version is >= the patch version and < the next non-patch version\r\n- The field will be read if the transport version is >= version the field was added\r\n\r\nThere are versions in-between the patch version and the _version the field was added_ where the field will not be written",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T16:28:27Z",
        "closed_at": "2023-10-11T07:16:03Z",
        "merged_at": "2023-10-11T07:16:03Z",
        "body": "This time more segments were created than expected, because IWC#maxBufferedDocs was randomily set to a very small number causing more segments to be created then expected.\r\n\r\nI also run this test again with -Dtests.iters=1024 without failure. So hopefully this test will not fail again because of random test issues.\r\n\r\nCloses #100580",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 2,
        "changed_files": 3,
        "created_at": "2023-10-10T16:24:43Z",
        "closed_at": "2023-10-11T04:57:08Z",
        "merged_at": "2023-10-11T04:57:08Z",
        "body": "This PR makes the clean-up feature set `actions` to `data_frame/transforms*` (added wildcard `*`) to catch all the transform tasks while issuing `_tasks` request.\r\n\r\nRelates https://github.com/elastic/elasticsearch/issues/100596",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T16:00:04Z",
        "closed_at": "2023-10-10T16:54:15Z",
        "merged_at": "2023-10-10T16:54:15Z",
        "body": "Backports the following commits to 8.11:\n - [ML] Unmute now fixed JobUpdateTest/testMergeWithJob (#100611)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-10T15:54:22Z",
        "closed_at": "2023-10-10T17:33:31Z",
        "merged_at": "2023-10-10T17:33:31Z",
        "body": "This update the visibility field in ESQL's REST spec to public.\r\n\r\nIt also updates the types of quotes used for one the REST object paramter to backticks, to be consistent.\r\n",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 61,
        "deletions": 50,
        "changed_files": 1,
        "created_at": "2023-10-10T15:39:44Z",
        "closed_at": "2023-10-11T06:05:13Z",
        "merged_at": "2023-10-11T06:05:13Z",
        "body": "Relates #100568",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T15:35:06Z",
        "closed_at": "2023-10-10T15:53:15Z",
        "merged_at": "2023-10-10T15:53:15Z",
        "body": "Backports the following commits to 8.11:\n - Update 8.10.3.asciidoc (#100590) (#100614)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T15:25:57Z",
        "closed_at": "2023-10-10T16:11:15Z",
        "merged_at": "2023-10-10T16:11:15Z",
        "body": "Revert \"[CI] Mute MlHiddenIndicesFullClusterRestartIT.testMlIndicesBecomeHidden\" (#93523)\r\n\r\nThis reverts commit 725da76b70cad8e864bd150ac76f08d1f3312a8a.\r\n\r\nThis change fixes #93521\r\n\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 418,
        "deletions": 384,
        "changed_files": 3,
        "created_at": "2023-10-10T15:24:51Z",
        "closed_at": "2023-10-11T06:03:32Z",
        "merged_at": "2023-10-11T06:03:32Z",
        "body": "Introduces the `SnapshotsDeletion` class which encapsulates the process\r\nof deleting some collection of snapshots. In particular this class gives\r\nus somewhere to store various deletion-wide data which significantly\r\nreduces the length of some argument lists.\r\n\r\nRelates #100568",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T15:22:28Z",
        "closed_at": "2023-10-10T16:02:53Z",
        "merged_at": "2023-10-10T16:02:53Z",
        "body": "Backports the following commits to 8.11:\n - Re-enable org.elasticsearch.xpack.esql.action.EsqlActionIT.testFilterWithNullAndEvalFromIndex (#100604)",
        "comments": 0
    },
    {
        "merged": false,
        "additions": 54,
        "deletions": 3,
        "changed_files": 3,
        "created_at": "2023-10-10T15:21:23Z",
        "closed_at": null,
        "merged_at": null,
        "body": "When deserializing a BytesReference from a StreamInput we are always allocating all the bytes in a byte array. This can lead to humongous allocation in G1 that adds pressure to GC.  This PR changes the approach and it uses a non-recycible ByteArray to create the BytesReference that should use pagination if the array is too big.\r\n\r\nrelated to  https://github.com/elastic/elasticsearch/issues/99590",
        "comments": 22
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T15:12:09Z",
        "closed_at": "2023-10-10T15:31:03Z",
        "merged_at": "2023-10-10T15:31:03Z",
        "body": "# Backport\n\nThis will backport the following commits from `8.10` to `main`:\n - [Update 8.10.3.asciidoc (#100590)](https://github.com/elastic/elasticsearch/pull/100590)\n\n<!--- Backport version: 8.9.7 -->\n\n### Questions ?\nPlease refer to the [Backport tool documentation](https://github.com/sqren/backport)",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 16,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-10T15:10:11Z",
        "closed_at": "2023-10-10T15:54:40Z",
        "merged_at": "2023-10-10T15:54:40Z",
        "body": "Backports the following commits to 8.11:\n - Fix NPE in DocVector ramBytesUsed (#100575)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 12,
        "changed_files": 7,
        "created_at": "2023-10-10T15:09:20Z",
        "closed_at": "2023-10-10T15:52:07Z",
        "merged_at": "2023-10-10T15:52:07Z",
        "body": "Backports the following commits to 8.11:\n - ESQL Fix array Block ramBytesUsed (#100578)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T15:04:23Z",
        "closed_at": "2023-10-10T15:57:33Z",
        "merged_at": "2023-10-10T15:57:33Z",
        "body": "Closes #98626\r\n",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 129,
        "deletions": 4,
        "changed_files": 4,
        "created_at": "2023-10-10T14:54:37Z",
        "closed_at": "2023-10-11T08:54:09Z",
        "merged_at": "2023-10-11T08:54:09Z",
        "body": "`IndexShard#markAllocationIdAsInSync` is interruptible because it may\r\nblock the thread on a monitor waiting for the local checkpoint to\r\nadvance, but we lost the ability to interrupt it on a recovery\r\ncancellation in #95270.\r\n\r\nCloses #96578\r\nCloses #100589",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 162,
        "deletions": 11,
        "changed_files": 4,
        "created_at": "2023-10-10T14:39:27Z",
        "closed_at": "2023-10-10T18:28:02Z",
        "merged_at": "2023-10-10T18:28:02Z",
        "body": "OTEL gaguges should follow the callback model otherwise they will not be sent by apm java agent. (or use BatchCallback)\r\nThis commit changes the gagues creation model to return Observable*Gauge and uses AtomicLong/Double to store current value which will be polled when metrics are exported (and callback is called).\r\n",
        "comments": 2
    },
    {
        "merged": false,
        "additions": 0,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-10T14:18:14Z",
        "closed_at": "2023-10-10T15:09:28Z",
        "merged_at": null,
        "body": "Removing the `Coming in 8.10.3` line from the release notes now that 8.10.3 has been released",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 0,
        "changed_files": 5,
        "created_at": "2023-10-10T14:05:45Z",
        "closed_at": "2023-10-10T15:02:56Z",
        "merged_at": "2023-10-10T15:02:56Z",
        "body": "Backports the following commits to 8.11:\n - Allow VectorFixedBuilder to become released without build (#100567)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 111,
        "deletions": 15,
        "changed_files": 7,
        "created_at": "2023-10-10T14:04:54Z",
        "closed_at": "2023-10-10T17:00:58Z",
        "merged_at": "2023-10-10T17:00:57Z",
        "body": "Backports the following commits to 8.11:\n - Use separate search execution context for each pipeline (#100563)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T14:01:57Z",
        "closed_at": "2023-10-10T14:46:18Z",
        "merged_at": "2023-10-10T14:46:18Z",
        "body": "This excludes 8.10.3 from the RepositoryData BWC test, related to #100447.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T13:57:38Z",
        "closed_at": "2023-10-10T15:21:17Z",
        "merged_at": "2023-10-10T15:21:17Z",
        "body": "This commit re-enables org.elasticsearch.xpack.esql.action.EsqlActionIT.testFilterWithNullAndEvalFromIndex, which now passes successfully.",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 6,
        "deletions": 6,
        "changed_files": 2,
        "created_at": "2023-10-10T13:41:49Z",
        "closed_at": null,
        "merged_at": null,
        "body": "<!--\r\nThank you for your interest in and contributing to Elasticsearch! There\r\nare a few simple things to check before submitting your pull request\r\nthat can help with the review process. You should delete these items\r\nfrom your submission, but they are here to help bring them to your\r\nattention.\r\n-->\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)?\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)?\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`?\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed.\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)?\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.\r\n",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 106,
        "deletions": 35,
        "changed_files": 2,
        "created_at": "2023-10-10T13:24:45Z",
        "closed_at": "2023-10-10T19:41:42Z",
        "merged_at": "2023-10-10T19:41:42Z",
        "body": "This commit fixes a failure in BlockAccountingTests, and adds a new filter test scenario that filters on the last position of a multivalue.\r\n\r\ncloses  #100586\r\n",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 117,
        "deletions": 4,
        "changed_files": 3,
        "created_at": "2023-10-10T13:19:52Z",
        "closed_at": null,
        "merged_at": null,
        "body": "`DiskThresholdDecider` may compute an average disk usage if the real disk usage of a node is unknown. This average disk usage computes the average total disk space and free disk space among all nodes, but that can break if nodes are using huge filesystems or if the sum of total/free bytes exceeds Long.MAX_VALUE (we've seen total bytes being negative in some clusters).\r\n\r\nThis change introduces an early check in `DiskThresholdDecider` to detect such situation and treat it as if nodes disk usages were unknown, returning a `YES` decision for allocation. This is the less impactful solution I can find for this bug but I'm open to other suggestions.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 413,
        "deletions": 93,
        "changed_files": 6,
        "created_at": "2023-10-10T13:13:18Z",
        "closed_at": "2023-10-11T14:28:20Z",
        "merged_at": "2023-10-11T14:28:20Z",
        "body": "Let MV_EXPAND operator paginate the output, so that the memory footprint remains low.\r\n\r\nNow also queries like \r\n\r\n```\r\nrow \r\na = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], \r\nb = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], \r\nc = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], \r\nd = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], \r\ne = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], \r\nf = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], \r\ng = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], \r\nx = 10000000000000 \r\n| mv_expand a | mv_expand b | mv_expand c | mv_expand d | mv_expand e | mv_expand f | mv_expand g\r\n```\r\n\r\nconsume a small amount of memory and avoid to calculate elements that will be discarded by a subsequent LIMIT.\r\n\r\nFixes #100533\r\n",
        "comments": 7
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T13:01:14Z",
        "closed_at": "2023-10-10T14:01:00Z",
        "merged_at": "2023-10-10T14:01:00Z",
        "body": "MatchingDirectoryReader is a test reader wrapper that filters out \r\ndocuments matching a particular query. For each leaf, we create an \r\nIndexSearcher, execute the query against it and then use that as a \r\nfilter for the leaf. This searcher is created using LuceneTestCase.newSearcher() \r\nand as such may be multi- threaded, which triggers extra index checks. \r\nFor tests that are expecting certain methods to be called against internal \r\nreaders a given number of times, these extra checks can add additional \r\ncalls which then lead to a failure of test assumptions.\r\n\r\nBecause this IndexSearcher is only executed against a single leaf it will \r\nonly ever use a single thread, and so we can explicitly disable threading here.\r\n\r\nFixes #100487\r\nFixes #99916\r\nFixes #100460",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 22,
        "deletions": 0,
        "changed_files": 3,
        "created_at": "2023-10-10T12:37:22Z",
        "closed_at": "2023-10-13T05:30:13Z",
        "merged_at": "2023-10-13T05:30:13Z",
        "body": "With this commit we amend the `viewer` and `editor` roles so that access to the index patterns related to Universal Profiling is possible. The `editor` role gets the same permissions as `viewer` for these index patterns because it does not make sense to write to these indices directly (i.e. instead of the collector / symbolizer doing that).",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 24,
        "deletions": 26,
        "changed_files": 4,
        "created_at": "2023-10-10T12:13:04Z",
        "closed_at": "2023-10-11T11:33:01Z",
        "merged_at": "2023-10-11T11:33:01Z",
        "body": "We suspect the [synthetic source](https://github.com/elastic/elasticsearch/pull/98808/files#diff-4fdd004cb784f3abf8d00cc511cdd2f3fe5e4d557aa308dca067613938708575) test for tsdb mappings that was added in #98808 may be contributing to flakiness in mixed cluster tests.\r\n\r\nThis change also reverts #100572 since it doesn't work as expected - see [comment](https://github.com/elastic/elasticsearch/pull/100592#issuecomment-1755632150) below. \r\n\r\nFixes #100562\r\n",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-10T12:05:06Z",
        "closed_at": "2023-10-10T13:07:51Z",
        "merged_at": "2023-10-10T13:07:51Z",
        "body": "Removes coming in 7.17.14 tag",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T12:03:58Z",
        "closed_at": "2023-10-10T13:07:42Z",
        "merged_at": "2023-10-10T13:07:42Z",
        "body": "Removes coming in 8.10.3 tag",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 476,
        "deletions": 152,
        "changed_files": 27,
        "created_at": "2023-10-10T11:14:52Z",
        "closed_at": "2023-10-11T14:10:18Z",
        "merged_at": "2023-10-11T14:10:18Z",
        "body": "Backport of #100345",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T10:44:30Z",
        "closed_at": "2023-10-10T21:12:36Z",
        "merged_at": "2023-10-10T21:12:36Z",
        "body": "This suite now has a couple of thousand tests, some of which take a\r\ncouple of seconds, so it times out occasionally. Relaxing the timeout\r\nfurther.",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
        "created_at": "2023-10-10T10:01:24Z",
        "closed_at": "2023-10-11T08:32:58Z",
        "merged_at": "2023-10-11T08:32:58Z",
        "body": "The build automation didn't work properly for freezing 8.11, the min ccs version didn't update. This sets it to the version used for 8.11",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 9,
        "deletions": 0,
        "changed_files": 3,
        "created_at": "2023-10-10T09:52:50Z",
        "closed_at": "2023-10-12T14:37:23Z",
        "merged_at": "2023-10-12T14:37:23Z",
        "body": "With this commit we add the required annotations so that Universal Profiling APIs can be called in Serverless. Outside of Serverless these annotations don't alter behavior.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 0,
        "deletions": 3,
        "changed_files": 1,
        "created_at": "2023-10-10T09:36:12Z",
        "closed_at": "2023-10-10T10:24:31Z",
        "merged_at": "2023-10-10T10:24:31Z",
        "body": "In order to determine risk I would like to enable this test again.\r\n\r\nRelates to #91637 ",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 9,
        "deletions": 20,
        "changed_files": 9,
        "created_at": "2023-10-10T09:31:19Z",
        "closed_at": "2023-10-10T15:08:13Z",
        "merged_at": "2023-10-10T15:08:13Z",
        "body": "This commit removes the MvOrdering enum from array Block ramBytesUsed. The enum value is shared.\r\n\r\ncloses #100559",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 41,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-10T09:26:57Z",
        "closed_at": "2023-10-10T09:44:19Z",
        "merged_at": "2023-10-10T09:44:19Z",
        "body": "Backports the following commits to 8.10:\n - Add known-issue docs for snapshot downgrades bug (#100412)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 41,
        "deletions": 1,
        "changed_files": 3,
        "created_at": "2023-10-10T09:26:43Z",
        "closed_at": "2023-10-10T09:43:32Z",
        "merged_at": "2023-10-10T09:43:32Z",
        "body": "Backports the following commits to 8.11:\n - Add known-issue docs for snapshot downgrades bug (#100412)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 16,
        "deletions": 1,
        "changed_files": 2,
        "created_at": "2023-10-10T09:11:10Z",
        "closed_at": "2023-10-10T15:08:50Z",
        "merged_at": "2023-10-10T15:08:50Z",
        "body": "This commit fixes a potential NPE in DocVector::ramBytesUsed.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-10T09:07:21Z",
        "closed_at": "2023-10-10T15:18:49Z",
        "merged_at": "2023-10-10T15:18:49Z",
        "body": "<!--\r\nThank you for your interest in and contributing to Elasticsearch! There\r\nare a few simple things to check before submitting your pull request\r\nthat can help with the review process. You should delete these items\r\nfrom your submission, but they are here to help bring them to your\r\nattention.\r\n-->\r\n\r\n- Have you signed the [contributor license agreement](https://www.elastic.co/contributor-agreement)? yes\r\n- Have you followed the [contributor guidelines](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md)? yes\r\n- If submitting code, have you built your formula locally prior to submission with `gradle check`? yes\r\n- If submitting code, is your pull request against main? Unless there is a good reason otherwise, we prefer pull requests against main and will backport as needed. yes\r\n- If submitting code, have you checked that your submission is for an [OS and architecture that we support](https://www.elastic.co/support/matrix#show_os)? yes\r\n- If you are submitting this code for a class then read our [policy](https://github.com/elastic/elasticsearch/blob/main/CONTRIBUTING.md#contributing-as-part-of-a-class) for that.\r\n\r\nRequired for https://github.com/elastic/kibana/pull/168435 to allow kibana task to write agent metrics to `metrics-fleet_server*` data streams that will be installed by fleet-server integration.",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 26,
        "deletions": 18,
        "changed_files": 3,
        "created_at": "2023-10-10T08:50:20Z",
        "closed_at": "2023-10-10T11:37:07Z",
        "merged_at": "2023-10-10T11:37:07Z",
        "body": "#98808 restored printing `source: synthetic` in time-series index mappings. However, there is an old assert that triggers intermittently in mixedClusterTest due mismatching mapping printing for old and new versions of the mapping. To avoid this, we revert to the old behavior for indexes created between 8.7 (where synthetic source became the default for TSDB) and 8.10 (where synthetic source was restored in the mapping printing).\r\n\r\nFixes #100562",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 2486,
        "deletions": 638,
        "changed_files": 21,
        "created_at": "2023-10-10T08:49:14Z",
        "closed_at": "2023-10-10T09:06:40Z",
        "merged_at": "2023-10-10T09:06:40Z",
        "body": "Backports the following commits to 8.11:\n - [DOCS] Refresh \"Search your data\" (#99482)",
        "comments": 1
    },
    {
        "merged": false,
        "additions": 88,
        "deletions": 21,
        "changed_files": 6,
        "created_at": "2023-10-10T08:22:12Z",
        "closed_at": null,
        "merged_at": null,
        "body": "The metric is called `elasticsearch.blob_cache.evicted_count_non_zero_frequency` and is incremented in both `maybeEvict` and `forceEvict` if the entry was evicted and the frequency count (`entry.freq`) is greater than 0.\r\nFor tests we are passing a `Meter.NOOP` while in production code we are using the meter passed in the `TelemetryProvider` at `SearchableSnapshot::createComponents`",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 293,
        "deletions": 254,
        "changed_files": 10,
        "created_at": "2023-10-10T06:57:46Z",
        "closed_at": "2023-10-10T12:39:59Z",
        "merged_at": "2023-10-10T12:39:59Z",
        "body": "Reorders the methods involved in snapshot deletion to be closer together\r\nand better match the flow of execution, and harmonises the names of many\r\nparameters and local variables to make it easier to follow them through\r\nthe process.",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 5,
        "deletions": 0,
        "changed_files": 5,
        "created_at": "2023-10-10T05:49:57Z",
        "closed_at": "2023-10-10T14:04:38Z",
        "merged_at": "2023-10-10T14:04:38Z",
        "body": "VectorFixedBuilder can be closed without calling build and we should move its state to released in this case.",
        "comments": 4
    },
    {
        "merged": true,
        "additions": 34,
        "deletions": 6,
        "changed_files": 2,
        "created_at": "2023-10-10T05:43:33Z",
        "closed_at": "2023-10-11T06:09:09Z",
        "merged_at": "2023-10-11T06:09:09Z",
        "body": "ValuesSource can be Null instead of Bytes when a shard has no data for a specific field. This PR relaxes the check for ValueSources in the OrdinalsGroupingOperator.\r\n\r\nWe will need to add more tests for OrdinalsGroupingOperator.\r\n\r\nCloses #100438",
        "comments": 5
    },
    {
        "merged": true,
        "additions": 43,
        "deletions": 0,
        "changed_files": 3,
        "created_at": "2023-10-10T04:53:18Z",
        "closed_at": "2023-10-11T05:00:42Z",
        "merged_at": "2023-10-11T05:00:42Z",
        "body": "The LocalExporter would call `clusterService.state()` as part of a scheduled runnable, however this could end up running before the cluster state was recovered, and calling state() before recovery is not permitted (this trips an assertion in tests)\r\n\r\nThe class already listened to cluster events and detected when cluster state recovery was complete, this commit causes the scheduled cleanup method to do nothing if the recovery event has not yet been received.\r\n",
        "comments": 3
    },
    {
        "merged": false,
        "additions": 307,
        "deletions": 113,
        "changed_files": 32,
        "created_at": "2023-10-10T02:04:51Z",
        "closed_at": null,
        "merged_at": null,
        "body": "This adds more tests for some of the `MV_` functions and updates their docs now that the railroad diagram and table generated by the tests covers all of the types.\r\n",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 111,
        "deletions": 15,
        "changed_files": 7,
        "created_at": "2023-10-10T01:21:17Z",
        "closed_at": "2023-10-10T14:03:30Z",
        "merged_at": "2023-10-10T14:03:30Z",
        "body": "Synthetic source doesn't seem to work correctly with either inter-segment or intra-segment parallelism. Neither of these parallelisms were available when the synthetic source was developed. The new test fails with the doc or segment data_partitioning. While we are working on a proper fix, this PR introduces a workaround by creating a separate search execution context for each execution pipeline, restoring the sequential execution invariants. I believe that the overhead added by this workaround is minimal.",
        "comments": 7
    },
    {
        "merged": false,
        "additions": 932,
        "deletions": 38,
        "changed_files": 9,
        "created_at": "2023-10-09T22:36:34Z",
        "closed_at": "2023-10-11T19:59:52Z",
        "merged_at": null,
        "body": "Adds a base retriever, classic retriever, and the appropriate infrastructure to `SearchModule` and `SearchPlugin` to support additional retrievers. This only covers the parsing portion of the classic retriever as part of a search query. Once parsed, the classic retriever will populate the appropriate values of the `SearchSourceBuilder`. The next step is having the classic retriever replace sections of `SearchSourceBuilder` and passed into the shards through `ShardSearchRequest`.",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 4,
        "changed_files": 2,
        "created_at": "2023-10-09T21:40:33Z",
        "closed_at": "2023-10-10T13:59:41Z",
        "merged_at": "2023-10-10T13:59:41Z",
        "body": "Backports the following commits to 8.11:\n - [DOCS] Update links to migrating Search docs (#100237)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 8,
        "deletions": 9,
        "changed_files": 1,
        "created_at": "2023-10-09T21:24:17Z",
        "closed_at": "2023-10-10T12:53:04Z",
        "merged_at": "2023-10-10T12:53:04Z",
        "body": "Fixes serialization random versioning.\r\n\r\ncloses: https://github.com/elastic/elasticsearch/issues/100289\r\n\r\n",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 3,
        "deletions": 5,
        "changed_files": 1,
        "created_at": "2023-10-09T21:17:39Z",
        "closed_at": "2023-10-10T01:50:47Z",
        "merged_at": "2023-10-10T01:50:47Z",
        "body": "This changes an assertion in a test for median absolute deviation that hit floating point rounding errors. It happens fairly rarely, maybe 2% of the time but is reproducable with the right key.\r\n",
        "comments": 3
    },
    {
        "merged": true,
        "additions": 3,
        "deletions": 0,
        "changed_files": 1,
        "created_at": "2023-10-09T21:06:07Z",
        "closed_at": "2023-10-09T21:47:13Z",
        "merged_at": "2023-10-09T21:47:13Z",
        "body": "Follow up to #99922. Removing `org.gradle.java.installations.fromEnv` from our `gradle.properties` file had the side effect of breaking the `RUNTIME_JAVA_HOME` environment variable since Gradle is unaware of this toolchain. We need to add `RUNTIME_JAVA_HOME` back here so that setting this environment variable still works and avoid failures like this one: https://gradle-enterprise.elastic.co/s/gaezgaglsn76o/failure?expanded-stacktrace=WyIwLTEtMiJd#1",
        "comments": 2
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 3,
        "changed_files": 1,
        "created_at": "2023-10-09T21:00:22Z",
        "closed_at": "2023-10-09T21:38:53Z",
        "merged_at": "2023-10-09T21:38:53Z",
        "body": "Backports the following commits to 8.11:\n - Fix test (#100547)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 1,
        "deletions": 2,
        "changed_files": 1,
        "created_at": "2023-10-09T20:36:52Z",
        "closed_at": "2023-10-09T21:18:05Z",
        "merged_at": "2023-10-09T21:18:05Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Remove unnecessary AwaitsFix (#100543)",
        "comments": 0
    },
    {
        "merged": true,
        "additions": 2,
        "deletions": 5,
        "changed_files": 2,
        "created_at": "2023-10-09T20:29:39Z",
        "closed_at": "2023-10-09T21:12:18Z",
        "merged_at": "2023-10-09T21:12:18Z",
        "body": "Backports the following commits to 8.11:\n - ESQL: Don't log the parse tree (#100545)",
        "comments": 1
    },
    {
        "merged": true,
        "additions": 4,
        "deletions": 6,
        "changed_files": 1,
        "created_at": "2023-10-09T20:28:54Z",
        "closed_at": "2023-10-09T21:09:51Z",
        "merged_at": "2023-10-09T21:09:51Z",
        "body": "Backports the following commits to 8.11:\n - Make test result deterministic (#100539)",
        "comments": 0
    }
]